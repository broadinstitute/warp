"use strict";(self.webpackChunkwebsite_2=self.webpackChunkwebsite_2||[]).push([[2173],{5680:(e,t,i)=>{i.d(t,{xA:()=>d,yg:()=>h});var n=i(6540);function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),i=t;return e&&(i="function"==typeof e?e(t):o(o({},t),e)),i},d=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var i=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=p(i),m=r,h=c["".concat(l,".").concat(m)]||c[m]||u[m]||a;return i?n.createElement(h,o(o({ref:t},d),{},{components:i})):n.createElement(h,o({ref:t},d))}));function h(e,t){var i=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=i.length,o=new Array(a);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<a;p++)o[p]=i[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,i)}m.displayName="MDXCreateElement"},8926:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var n=i(9668),r=(i(6540),i(5680));const a={sidebar_position:2},o="Optimus v5.3.0 Methods",s={unversionedId:"Pipelines/Optimus_Pipeline/optimus.methods",id:"Pipelines/Optimus_Pipeline/optimus.methods",title:"Optimus v5.3.0 Methods",description:"Below we provide an example methods section for a publication, separated into single-cell or single-nucleus use cases. For the complete pipeline documentation, see the Optimus Overview.",source:"@site/docs/Pipelines/Optimus_Pipeline/optimus.methods.md",sourceDirName:"Pipelines/Optimus_Pipeline",slug:"/Pipelines/Optimus_Pipeline/optimus.methods",permalink:"/warp/docs/Pipelines/Optimus_Pipeline/optimus.methods",draft:!1,editUrl:"https://github.com/broadinstitute/warp/edit/develop/website/docs/Pipelines/Optimus_Pipeline/optimus.methods.md",tags:[],version:"current",lastUpdatedBy:"dependabot[bot]",lastUpdatedAt:1731595392,formattedLastUpdatedAt:"Nov 14, 2024",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docsSidebar",previous:{title:"Optimus Overview",permalink:"/warp/docs/Pipelines/Optimus_Pipeline/README"},next:{title:"What tags are included in an Optimus BAM file?",permalink:"/warp/docs/Pipelines/Optimus_Pipeline/Bam_tags"}},l={},p=[{value:"Single-cell (sc_rna mode)",id:"single-cell-sc_rna-mode",level:2},{value:"Single-nucleus (sn_rna mode)",id:"single-nucleus-sn_rna-mode",level:2}],d={toc:p},c="wrapper";function u(e){let{components:t,...i}=e;return(0,r.yg)(c,(0,n.A)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"optimus-v530-methods"},"Optimus v5.3.0 Methods"),(0,r.yg)("p",null,"Below we provide an example methods section for a publication, separated into single-cell or single-nucleus use cases. For the complete pipeline documentation, see the ",(0,r.yg)("a",{parentName:"p",href:"/warp/docs/Pipelines/Optimus_Pipeline/README"},"Optimus Overview"),"."),(0,r.yg)("h1",{id:"methods"},"Methods"),(0,r.yg)("h2",{id:"single-cell-sc_rna-mode"},"Single-cell (sc_rna mode)"),(0,r.yg)("p",null,"Data preprocessing and count matrix construction were performed using the Optimus v5.3.0 pipeline (RRID:SCR_018908). Briefly, FASTQ files were partitioned by barcodes using sctools v0.3.13. The files were then trimmed, aligned, UMI-corrected against the 10x Genomics barcodes whitelist, and converted to a raw count matrix using STAR v2.7.9a. CB correction was performed using the  ",(0,r.yg)("inlineCode",{parentName:"p"},"--soloCBmatchWLtype 1MM_multi_Nbase_pseudocounts")," parameter which allowed for multiple matches in the whitelist with 1 mismatched base, used posterior probability calculation to choose one of the matches, added pseudocounts of 1 to all whitelist barcodes, and allowed multi-matching of CBs with N-bases to the whitelist.  "),(0,r.yg)("p",null,"Reads were trimmed using the solo parameter ",(0,r.yg)("inlineCode",{parentName:"p"},"--clipAdapterType CellRanger4")," and  ",(0,r.yg)("inlineCode",{parentName:"p"},"--outFilterScoreMin 30"),' which matches read trimming performed by CellRanger4. Reads were then aligned to GENCODE mouse (M21) or human (V27) references in unstranded mode. Genes were annotated using the STAR "Gene" COUNTING_MODE and UMIs were corrected with the ',(0,r.yg)("inlineCode",{parentName:"p"},"--soloUMIdedup 1MM_Directional_UMItoolsdirectional")," parameter, which uses a directional correction method. The resulting BAM was then used for cell and gene metric correction using the sctools v0.3.13 TagSortBam tool. The STAR TSV outputs for gene counts, features, and barcodes were converted to numpy arrays for downstream empty droplet detection using DropletUtils v1.2.1 emptyDrops with the parameters\n",(0,r.yg)("inlineCode",{parentName:"p"},"--fdr-cutoff 0.01 --emptydrops-niters 10000 --min-molecules 100 --emptydrops-lower 100"),"."),(0,r.yg)("p",null,"All cell and gene metrics (alignment, mitochondrial, and other QC metrics), count matrices, and emptyDrops results were aggregated into a final Loom-formatted cell-by-gene matrix. The final outputs included the unfiltered Loom and unfiltered (but tagged) BAM file."),(0,r.yg)("p",null,"An example of the pipeline and outputs is available on the Terra HCA Optimus Pipeline Featured Workspace (",(0,r.yg)("a",{parentName:"p",href:"https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline"},"https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline"),"), and an additional pipeline overview is available in ",(0,r.yg)("a",{parentName:"p",href:"https://broadinstitute.github.io/warp/docs/Pipelines/Optimus_Pipeline/README"},"WARP documentation"),". Examples of genomic references, whitelists, and other inputs are available in the WARP repository (see the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/tree/master/pipelines/skylab/optimus/example_inputs"},"example inputs"),")."),(0,r.yg)("h2",{id:"single-nucleus-sn_rna-mode"},"Single-nucleus (sn_rna mode)"),(0,r.yg)("p",null,"Data preprocessing and count matrix construction were performed using the Optimus v5.3.0 pipeline (RRID:SCR_018908). Briefly, FASTQ files were partitioned by barcodes using sctools v0.3.13. The files were then trimmed, aligned, UMI-corrected against the 10x Genomics barcodes whitelist, and converted to a raw count matrix using STAR v2.7.9a. CB correction was performed using the ",(0,r.yg)("inlineCode",{parentName:"p"},"--soloCBmatchWLtype 1MM_multi_Nbase_pseudocounts")," parameter which allowed for multiple matches in the whitelist with 1 mismatched base, used posterior probability calculation to choose one of the matches, added pseudocounts of 1 to all whitelist barcodes, and allowed multi-matching of CBs with N-bases to the whitelist.  "),(0,r.yg)("p",null,"Reads were trimmed using the solo parameter ",(0,r.yg)("inlineCode",{parentName:"p"},"--clipAdapterType CellRanger4")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"--outFilterScoreMin 30"),' which matches read trimming performed by CellRanger4. Reads were then aligned to GENCODE mouse (M21) or human (V27) references in unstranded mode. Genes were annotated using the STAR "GeneFull" COUNTING_MODE and UMIs were corrected with the ',(0,r.yg)("inlineCode",{parentName:"p"},"--soloUMIdedup 1MM_Directional_UMItoolsdirectional")," parameter, which uses a directional correction method. The resulting BAM was then used for cell and gene metric correction using the sctools v0.3.13 TagSortBam tool. The STAR TSV outputs for gene counts, features, and barcodes were converted to numpy arrays for downstream Loom conversion. "),(0,r.yg)("p",null,"All cell and gene metrics (alignment, mitochondrial, and other QC metrics) and count matrices were aggregated into a final Loom-formatted cell-by-gene matrix. The final outputs included the unfiltered Loom and unfiltered (but tagged) BAM file."),(0,r.yg)("p",null,"An example of the pipeline and outputs is available on the ",(0,r.yg)("a",{parentName:"p",href:"https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline"},"Terra HCA Optimus Pipeline Featured Workspace"),", and an additional pipeline overview is available in ",(0,r.yg)("a",{parentName:"p",href:"https://broadinstitute.github.io/warp/docs/Pipelines/Optimus_Pipeline/README"},"WARP documentation"),". Examples of genomic references, whitelists, and other inputs are available in the WARP repository (see the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/tree/master/pipelines/skylab/optimus/example_inputs"},"example inputs"),"."))}u.isMDXComponent=!0}}]);