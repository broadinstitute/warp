"use strict";(self.webpackChunkwebsite_2=self.webpackChunkwebsite_2||[]).push([[4478],{5680:(e,t,a)=>{a.d(t,{xA:()=>m,yg:()=>d});var n=a(6540);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},g="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),g=p(a),c=r,d=g["".concat(s,".").concat(c)]||g[c]||u[c]||i;return a?n.createElement(d,l(l({ref:t},m),{},{components:a})):n.createElement(d,l({ref:t},m))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[g]="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},8772:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var n=a(9668),r=(a(6540),a(5680));const i={sidebar_position:1,slug:"/Pipelines/Exome_Germline_Single_Sample_Pipeline/README"},l="Exome Germline Single Sample Overview",o={unversionedId:"Pipelines/Exome_Germline_Single_Sample_Pipeline/README",id:"Pipelines/Exome_Germline_Single_Sample_Pipeline/README",title:"Exome Germline Single Sample Overview",description:"| Pipeline Version | Date Updated | Documentation Author | Questions or Feedback |",source:"@site/docs/Pipelines/Exome_Germline_Single_Sample_Pipeline/README.md",sourceDirName:"Pipelines/Exome_Germline_Single_Sample_Pipeline",slug:"/Pipelines/Exome_Germline_Single_Sample_Pipeline/README",permalink:"/warp/docs/Pipelines/Exome_Germline_Single_Sample_Pipeline/README",draft:!1,editUrl:"https://github.com/broadinstitute/warp/edit/develop/website/docs/Pipelines/Exome_Germline_Single_Sample_Pipeline/README.md",tags:[],version:"current",lastUpdatedBy:"Robert Sidney Cox",lastUpdatedAt:1733411364,formattedLastUpdatedAt:"Dec 5, 2024",sidebarPosition:1,frontMatter:{sidebar_position:1,slug:"/Pipelines/Exome_Germline_Single_Sample_Pipeline/README"},sidebar:"docsSidebar",previous:{title:"BuildIndices Overview",permalink:"/warp/docs/Pipelines/BuildIndices_Pipeline/README"},next:{title:"Exome Germline Single Sample v3.1.19 Methods",permalink:"/warp/docs/Pipelines/Exome_Germline_Single_Sample_Pipeline/exome.methods"}},s={},p=[{value:"Set-up",id:"set-up",level:2},{value:"Workflow Installation and Requirements",id:"workflow-installation-and-requirements",level:3},{value:"Software Version Requirements",id:"software-version-requirements",level:3},{value:"Input Requirements and Expectations",id:"input-requirements-and-expectations",level:3},{value:"Workflow Tasks and Tools",id:"workflow-tasks-and-tools",level:2},{value:"Workflow Outputs",id:"workflow-outputs",level:2},{value:"Reblocking",id:"reblocking",level:3},{value:"Base quality scores",id:"base-quality-scores",level:3},{value:"Important Notes",id:"important-notes",level:2},{value:"Citing the Exome Germline Single Sample Pipeline",id:"citing-the-exome-germline-single-sample-pipeline",level:2},{value:"Contact Us",id:"contact-us",level:2},{value:"Licensing",id:"licensing",level:2}],m={toc:p},g="wrapper";function u(e){let{components:t,...a}=e;return(0,r.yg)(g,(0,n.A)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"exome-germline-single-sample-overview"},"Exome Germline Single Sample Overview"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Pipeline Version"),(0,r.yg)("th",{parentName:"tr",align:"center"},"Date Updated"),(0,r.yg)("th",{parentName:"tr",align:"center"},"Documentation Author"),(0,r.yg)("th",{parentName:"tr",align:"center"},"Questions or Feedback"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("a",{parentName:"td",href:"https://github.com/broadinstitute/warp/releases?q=ExomeGermlineSingleSample_v3.0.0&expanded=true"},"ExomeGermlineSingleSample_v3.1.19")),(0,r.yg)("td",{parentName:"tr",align:"center"},"March, 2024"),(0,r.yg)("td",{parentName:"tr",align:"center"},"Elizabeth Kiernan"),(0,r.yg)("td",{parentName:"tr",align:"center"},"Please ",(0,r.yg)("a",{parentName:"td",href:"https://github.com/broadinstitute/warp/issues"},"file an issue in WARP"),".")))),(0,r.yg)("p",null,"The Exome Germline Single Sample pipeline implements data pre-processing and initial variant calling according to the GATK Best Practices for germline SNP and Indel discovery in human exome sequencing data."),(0,r.yg)("p",null,"For a broad overview of the pipeline processes, read the GATK Best Practices documentation for ",(0,r.yg)("a",{parentName:"p",href:"https://gatk.broadinstitute.org/hc/en-us/articles/360035535912"},"data pre-processing")," and for ",(0,r.yg)("a",{parentName:"p",href:"https://gatk.broadinstitute.org/hc/en-us/articles/360035535932"},"germline short variant discovery"),"."),(0,r.yg)("admonition",{title:"Want to try the Exome Germline Single Sample pipeline?",type:"tip"},(0,r.yg)("p",{parentName:"admonition"},"You can test the pipeline in Terra! Go the ",(0,r.yg)("a",{parentName:"p",href:"https://app.terra.bio/#workspaces/warp-pipelines/Exome-Analysis-Pipeline"},"Exome-Analysis-Pipeline workspace")," which includes sample data and workflows for preprocessing and initial variant calling, sample map generation, and joint genotyping.")),(0,r.yg)("h2",{id:"set-up"},"Set-up"),(0,r.yg)("h3",{id:"workflow-installation-and-requirements"},"Workflow Installation and Requirements"),(0,r.yg)("p",null,"The Exome Germline Single Sample workflow is written in the Workflow Description Language WDL and can be downloaded by cloning the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/tree/master"},"warp repository")," in GitHub. The workflow can be deployed using ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/cromwell"},"Cromwell"),", a GA4GH compliant, flexible workflow management system that supports multiple computing platforms. For the latest workflow version and release notes, please see the Exome Germline Single Sample ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/blob/master/pipelines/broad/dna_seq/germline/single_sample/exome/ExomeGermlineSingleSample.changelog.md"},"changelog"),"."),(0,r.yg)("h3",{id:"software-version-requirements"},"Software Version Requirements"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://github.com/broadinstitute/gatk/releases/tag/4.5.0.0"},"GATK 4.5.0.0")),(0,r.yg)("li",{parentName:"ul"},"Picard 2.26.10"),(0,r.yg)("li",{parentName:"ul"},"Samtools 1.11"),(0,r.yg)("li",{parentName:"ul"},"Python 3.0"),(0,r.yg)("li",{parentName:"ul"},"Cromwell version support",(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"Successfully tested on v52"),(0,r.yg)("li",{parentName:"ul"},"Does not work on versions < v23 due to output syntax"))),(0,r.yg)("li",{parentName:"ul"},"Papi version support",(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"Successfully tested on Papi v2")))),(0,r.yg)("h3",{id:"input-requirements-and-expectations"},"Input Requirements and Expectations"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Human exome sequencing data in unmapped BAM (uBAM) format"),(0,r.yg)("li",{parentName:"ul"},"One or more read groups, one per uBAM file, all belonging to a single sample (SM)"),(0,r.yg)("li",{parentName:"ul"},"Input uBAM files must additionally comply with the following requirements:",(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},'Filenames all have the same suffix (we use ".unmapped.bam")'),(0,r.yg)("li",{parentName:"ul"},"Files must pass validation by ValidateSamFile"),(0,r.yg)("li",{parentName:"ul"},"Reads are provided in query-sorted order"),(0,r.yg)("li",{parentName:"ul"},"All reads must have an RG tag"))),(0,r.yg)("li",{parentName:"ul"},'Reblocked GVCF output names must end in ".rb.g.vcf.gz"'),(0,r.yg)("li",{parentName:"ul"},"Reference genome must be Hg38 with ALT contigs"),(0,r.yg)("li",{parentName:"ul"},"Unique exome calling, target, and bait ",(0,r.yg)("a",{parentName:"li",href:"https://gatk.broadinstitute.org/hc/en-us/articles/360035531852"},".interval_list")," obtained from the sequencing provider. Generally the calling, target, and bait files will not be the same.")),(0,r.yg)("h2",{id:"workflow-tasks-and-tools"},"Workflow Tasks and Tools"),(0,r.yg)("p",null,"The Exome Germline Single Sample ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/blob/master/pipelines/broad/dna_seq/germline/single_sample/exome/ExomeGermlineSingleSample.wdl"},"workflow")," imports a series of tasks from the WARP ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/tree/master/tasks/broad"},"tasks library")," and a DNASeq struct (",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/blob/master/structs/dna_seq/DNASeqStructs.wdl"},"DNASeqStructs.wdl"),") containing reference files from the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/tree/master/structs/dna_seq"},"structs library"),"."),(0,r.yg)("p",null,"You can read more about the software tools implemented in these tasks by reading the GATK ",(0,r.yg)("a",{parentName:"p",href:"https://gatk.broadinstitute.org/hc/en-us/articles/360035535912"},"data pre-processing")," and ",(0,r.yg)("a",{parentName:"p",href:"https://gatk.broadinstitute.org/hc/en-us/articles/360035535932"},"germline short variant discovery")," documentation."),(0,r.yg)("admonition",{title:"Want to use the Exome Germline Single Sample workflow in your publication?",type:"tip"},(0,r.yg)("p",{parentName:"admonition"},"Check out the workflow ",(0,r.yg)("a",{parentName:"p",href:"/warp/docs/Pipelines/Exome_Germline_Single_Sample_Pipeline/exome.methods"},"Methods")," to get started!")),(0,r.yg)("h2",{id:"workflow-outputs"},"Workflow Outputs"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"CRAM, CRAM index, and CRAM MD5"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://gatk.broadinstitute.org/hc/en-us/articles/360037593171"},"Reblocked")," GVCF and its GVCF index (read more in the ",(0,r.yg)("a",{parentName:"li",href:"#reblocking"},"Reblocking")," section below)"),(0,r.yg)("li",{parentName:"ul"},"BQSR report"),(0,r.yg)("li",{parentName:"ul"},"Summary metrics; to read more about any particular metric, you can search the metric using the ",(0,r.yg)("a",{parentName:"li",href:"https://gatk.broadinstitute.org/hc/en-us/categories/360002302312"},"GATK documentation search"))),(0,r.yg)("h3",{id:"reblocking"},"Reblocking"),(0,r.yg)("p",null,"Reblocking is a process that compresses a HaplotypeCaller GVCF by merging homRef blocks according to new genotype quality (GQ) bands and facilitates joint genotyping by removing alt alleles that do not appear in the called genotype. "),(0,r.yg)("p",null,"As of November 2021, reblocking is a default task in the Exome pipeline. To skip reblocking, add the following to the workflow's input configuration file (JSON):"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-WDL"},'"ExomeGermlineSingleSample.BamToGvcf.skip_reblocking": true\n')),(0,r.yg)("p",null,"The ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/blob/develop/tasks/broad/GermlineVariantDiscovery.wdl"},"Reblocking task")," uses the GATK ReblockGVCF tool with the arguments:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-WDL"},"-do-qual-approx -floor-blocks -GQB 20 -GQB 30 -GQB 40 \n")),(0,r.yg)("p",null,"The following summarizes how reblocking affects the Exome GVCF and downstream tools compared to the GVCF produced with the default HaplotypeCaller GQ bands:"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"PLs are omitted for homozygous reference sites to save space\u2013 GQs are output for genotypes, PLs can be approximated as ","[0, GQ, 2","*","GQ]",".")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"GQ resolution for homozygous reference genotypes is reduced (i.e. homRef GQs will be underconfident) which may affect analyses like de novo calling where well-calibrated reference genotype qualities are important.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Alleles that aren\u2019t called in the sample genotype are dropped. Each variant should have no more than two non-symbolic alt alleles, with the majority having just one plus <NON_REF>.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"New annotations enable merging data for filtering without using genotypes. For example:"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"RAW_GT_COUNT(S) for doing ExcessHet calculation from a sites-only file."),(0,r.yg)("li",{parentName:"ul"},"QUALapprox and/or AS_QUALapprox for doing QUAL approximation/filling. "),(0,r.yg)("li",{parentName:"ul"},"QUAL VCF field from a combined sites-only field."),(0,r.yg)("li",{parentName:"ul"},"VarDP and/or AS_VarDP used to calculate QualByDepth/QD annotation for VQSR."))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"The MIN_DP has been removed.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Reblocked GVCFs have the following cost/scale improvements:"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"A reduced storage footprint compared with HaplotypeCaller GVCF output."),(0,r.yg)("li",{parentName:"ul"},"Fewer VariantContexts (i.e. lines) per VCF which speeds up GenomicsDB/Hail import."),(0,r.yg)("li",{parentName:"ul"},"Fewer alternate alleles which reduce memory requirements for merging.")))),(0,r.yg)("p",null,"Additionally, the 4 GQ band schema has specific improvements compared with the 7-band schema:"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},"It does not drop GQ0s; reblocked GVCFs should cover all the positions that the input GVCF covers."),(0,r.yg)("li",{parentName:"ol"},"It has no overlaps; the only overlapping positions should be two variants (i.e. deletions) on separate haplotypes."),(0,r.yg)("li",{parentName:"ol"},"No more no-calls; all genotypes should be called. Positions with no data will be homRef with GQ0.")),(0,r.yg)("p",null,"Read more about the reblocked GVCFs in the ",(0,r.yg)("a",{parentName:"p",href:"https://broadinstitute.github.io/warp/blog/Nov21_ReblockedGVCF"},"WARP Blog"),"."),(0,r.yg)("h3",{id:"base-quality-scores"},"Base quality scores"),(0,r.yg)("p",null,"The final CRAM files have base quality scores binned according to the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/CCDG/Pipeline-Standardization/blob/master/PipelineStandard.md#base-quality-score-binning-scheme"},"Functional Equivalence specification")," (",(0,r.yg)("a",{parentName:"p",href:"https://www.nature.com/articles/s41467-018-06159-4"},"Regier et al., 2018"),")."),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Original Score"),(0,r.yg)("th",{parentName:"tr",align:null},"Score after BQSR recalibration"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"1-6"),(0,r.yg)("td",{parentName:"tr",align:null},"unchanged")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"7-12"),(0,r.yg)("td",{parentName:"tr",align:null},"10")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"13-22"),(0,r.yg)("td",{parentName:"tr",align:null},"20")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"22-infinity"),(0,r.yg)("td",{parentName:"tr",align:null},"30")))),(0,r.yg)("h2",{id:"important-notes"},"Important Notes"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Runtime parameters are optimized for Broad's Google Cloud Platform implementation."),(0,r.yg)("li",{parentName:"ul"},"For help running workflows on the Google Cloud Platform or locally please\nview the following tutorial ",(0,r.yg)("a",{parentName:"li",href:"https://gatk.broadinstitute.org/hc/en-us/articles/360035530952"},"(How to) Execute Workflows from the gatk-workflows Git Organization"),"."),(0,r.yg)("li",{parentName:"ul"},"Please visit the ",(0,r.yg)("a",{parentName:"li",href:"https://gatk.broadinstitute.org/hc/en-us/categories/360002310591"},"GATK Technical Documentation")," site for further documentation on our workflows and tools."),(0,r.yg)("li",{parentName:"ul"},"You can access relevant reference and resource bundles in the ",(0,r.yg)("a",{parentName:"li",href:"https://gatk.broadinstitute.org/hc/en-us/articles/360035890811"},"GATK Resource Bundle"),".")),(0,r.yg)("h2",{id:"citing-the-exome-germline-single-sample-pipeline"},"Citing the Exome Germline Single Sample Pipeline"),(0,r.yg)("p",null,"If you use the Exome Germline Single Sample Pipeline in your research, please consider citing our preprint:"),(0,r.yg)("p",null,"Degatano, K.; Awdeh, A.; Dingman, W.; Grant, G.; Khajouei, F.; Kiernan, E.; Konwar, K.; Mathews, K.; Palis, K.; Petrillo, N.; Van der Auwera, G.; Wang, C.; Way, J.; Pipelines, W. WDL Analysis Research Pipelines: Cloud-Optimized Workflows for Biological Data Processing and Reproducible Analysis. Preprints 2024, 2024012131. ",(0,r.yg)("a",{parentName:"p",href:"https://doi.org/10.20944/preprints202401.2131.v1"},"https://doi.org/10.20944/preprints202401.2131.v1")),(0,r.yg)("h2",{id:"contact-us"},"Contact Us"),(0,r.yg)("p",null,"This material is provided by the Data Science Platform group at the Broad Institute. Please direct any questions or concerns to one of our forum sites : ",(0,r.yg)("a",{parentName:"p",href:"https://gatk.broadinstitute.org/hc/en-us/community/topics"},"GATK")," or ",(0,r.yg)("a",{parentName:"p",href:"https://support.terra.bio/hc/en-us/community/topics/360000500432"},"Terra"),"."),(0,r.yg)("h2",{id:"licensing"},"Licensing"),(0,r.yg)("p",null,"Copyright Broad Institute, 2023 | BSD-3"),(0,r.yg)("p",null,"The workflow script is released under the ",(0,r.yg)("strong",{parentName:"p"},"WDL open source code license (BSD-3)")," (full license text at ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/broadinstitute/warp/blob/master/LICENSE"},"https://github.com/broadinstitute/warp/blob/master/LICENSE"),"). However, please note that the programs it calls may be subject to different licenses. Users are responsible for checking that they are authorized to run all programs before running this script."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://software.broadinstitute.org/gatk/download/licensing.php"},"GATK")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"http://bio-bwa.sourceforge.net/bwa.shtml#13"},"BWA")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://broadinstitute.github.io/picard/"},"Picard")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"http://www.htslib.org/terms/"},"Samtools"))))}u.isMDXComponent=!0}}]);