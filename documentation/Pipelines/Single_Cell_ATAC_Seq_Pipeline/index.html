<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Overview | WARP</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/warp/logo.png">
    <meta name="description" content="WDL Analysis Research Pipelines">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="og:locale" content="en_US">
    
    <link rel="preload" href="/warp/assets/css/0.styles.9e4f499e.css" as="style"><link rel="preload" href="/warp/assets/js/app.6148946b.js" as="script"><link rel="preload" href="/warp/assets/js/2.3c82beca.js" as="script"><link rel="preload" href="/warp/assets/js/10.2568daf3.js" as="script"><link rel="prefetch" href="/warp/assets/js/11.de13674c.js"><link rel="prefetch" href="/warp/assets/js/12.48f3249c.js"><link rel="prefetch" href="/warp/assets/js/13.b33887f2.js"><link rel="prefetch" href="/warp/assets/js/14.52da87ff.js"><link rel="prefetch" href="/warp/assets/js/15.41b0875b.js"><link rel="prefetch" href="/warp/assets/js/16.fcad7e22.js"><link rel="prefetch" href="/warp/assets/js/17.19040465.js"><link rel="prefetch" href="/warp/assets/js/18.5cd85943.js"><link rel="prefetch" href="/warp/assets/js/19.f71a8bf8.js"><link rel="prefetch" href="/warp/assets/js/20.417014aa.js"><link rel="prefetch" href="/warp/assets/js/21.ce8d83ec.js"><link rel="prefetch" href="/warp/assets/js/22.71cb5734.js"><link rel="prefetch" href="/warp/assets/js/23.c1051ff5.js"><link rel="prefetch" href="/warp/assets/js/24.b88a42f4.js"><link rel="prefetch" href="/warp/assets/js/25.5d2d381c.js"><link rel="prefetch" href="/warp/assets/js/26.a4e1c4c3.js"><link rel="prefetch" href="/warp/assets/js/27.b0c93a9b.js"><link rel="prefetch" href="/warp/assets/js/28.4d5eb7bb.js"><link rel="prefetch" href="/warp/assets/js/29.fdb4ccc6.js"><link rel="prefetch" href="/warp/assets/js/3.acd2e54e.js"><link rel="prefetch" href="/warp/assets/js/30.3f1148dd.js"><link rel="prefetch" href="/warp/assets/js/31.0c140f0a.js"><link rel="prefetch" href="/warp/assets/js/32.1f8e28eb.js"><link rel="prefetch" href="/warp/assets/js/33.f503b968.js"><link rel="prefetch" href="/warp/assets/js/34.bed1d686.js"><link rel="prefetch" href="/warp/assets/js/35.44ee75eb.js"><link rel="prefetch" href="/warp/assets/js/36.487613dc.js"><link rel="prefetch" href="/warp/assets/js/4.a326751d.js"><link rel="prefetch" href="/warp/assets/js/5.7e7dcbe0.js"><link rel="prefetch" href="/warp/assets/js/6.de7f6e39.js"><link rel="prefetch" href="/warp/assets/js/7.62d0c703.js"><link rel="prefetch" href="/warp/assets/js/8.373b9c67.js"><link rel="prefetch" href="/warp/assets/js/9.46c2760c.js">
    <link rel="stylesheet" href="/warp/assets/css/0.styles.9e4f499e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/warp/" class="home-link router-link-active"><!----> <span class="site-name">WARP</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/warp/documentation/Intro.html" class="nav-link">
  Documentation
</a></div><div class="nav-item"><a href="/warp/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Explore
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/warp/research/" class="nav-link">
  Research
</a></li></ul></li><li class="dropdown-item"><h4>
          Resources
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/warp/contribution/" class="nav-link">
  Contribution Guide
</a></li><li class="dropdown-subitem"><a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://github.com/broadinstitute/warp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/warp/documentation/Intro.html" class="nav-link">
  Documentation
</a></div><div class="nav-item"><a href="/warp/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Explore
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/warp/research/" class="nav-link">
  Research
</a></li></ul></li><li class="dropdown-item"><h4>
          Resources
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/warp/contribution/" class="nav-link">
  Contribution Guide
</a></li><li class="dropdown-subitem"><a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://github.com/broadinstitute/warp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Welcome to WARP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/warp/documentation/Intro.html" class="sidebar-link">Welcome to WARP</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>About WARP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/warp/documentation/About_WARP/BestPractices.html" class="sidebar-link">Best Practices for Building Data Processing Pipelines</a></li><li><a href="/warp/documentation/About_WARP/PipelineRequirements.html" class="sidebar-link">Pipeline Requirements</a></li><li><a href="/warp/documentation/About_WARP/TestingPipelines.html" class="sidebar-link">Testing Pipelines</a></li><li><a href="/warp/documentation/About_WARP/VersionAndReleasePipelines.html" class="sidebar-link">Version and Release Pipelines</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Pipelines</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>CEMBA MethylC Seq Pipeline</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Single Cell ATAC Seq Pipeline</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/" aria-current="page" class="active sidebar-link">Overview</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#table-of-contents" class="sidebar-link">Table of Contents</a></li><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#introduction" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#quick-start-table" class="sidebar-link">Quick Start Table</a></li></ul></li><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#set-up" class="sidebar-link">Set-up</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#workflow-installation-and-requirements" class="sidebar-link">Workflow Installation and Requirements</a></li><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#pipeline-inputs" class="sidebar-link">Pipeline Inputs</a></li><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#input-file-preparation" class="sidebar-link">Input File Preparation</a></li><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#task-summary" class="sidebar-link">Task Summary</a></li></ul></li><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#outputs" class="sidebar-link">Outputs</a></li><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#running-on-terra" class="sidebar-link">Running on Terra</a></li><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#versioning" class="sidebar-link">Versioning</a></li><li class="sidebar-sub-header"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/#pipeline-improvements" class="sidebar-link">Pipeline Improvements</a></li></ul></li><li><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/scatac.methods.html" class="sidebar-link">scATAC v1.1.0 Methods</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Exome Germline Single Sample Pipeline</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Illumina Genotyping Arrays Pipeline</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Optimus Pipeline</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Smart-seq2 Multi Sample Pipeline</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Smart-seq2 Single Sample Pipeline</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Whole Genome Germline Single Sample Pipeline</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h1> <table><thead><tr><th style="text-align:center;">Pipeline Version</th> <th style="text-align:center;">Date Updated</th> <th style="text-align:center;">Documentation Author</th> <th style="text-align:center;">Questions or Feedback</th></tr></thead> <tbody><tr><td style="text-align:center;"><a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer">scATAC 1.1.0 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:center;">August 24th 2020</td> <td style="text-align:center;"><a href="mailto:ekiernan@broadinstitute.org">Elizabeth Kiernan</a></td> <td style="text-align:center;">Please file GitHub issues in skylab or contact <a href="mailto:kdegatano@broadinstitute.org">Kylee Degatano</a></td></tr></tbody></table> <h2 id="table-of-contents"><a href="#table-of-contents" class="header-anchor">#</a> Table of Contents</h2> <ul><li><a href="#overview">Overview</a></li> <li><a href="#introduction">Introduction</a> <ul><li><a href="#quick-start-table">Quick Start Table</a></li></ul></li> <li><a href="#set-up">Set-up</a> <ul><li><a href="#workflow-installation-and-requirements">Workflow Installation and Requirements</a></li> <li><a href="#pipeline-inputs">Pipeline Inputs</a></li> <li><a href="#input-file-preparation">Input File Preparation</a> <ul><li><a href="#r1-and-r2-fastq-preparation">R1 and R2 FASTQ Preparation</a></li> <li><a href="#input_reference-preparation">Input_reference Preparation</a></li></ul></li></ul></li> <li><a href="#workflow-tasks-and-tools">Workflow Tasks and Tools</a> <ul><li><a href="#task-summary">Task Summary</a> <ul><li><a href="#alignpairedend">AlignPairedEnd</a></li> <li><a href="#snappre">SnapPre</a> <ul><li><a href="#filtering-parameters">Filtering Parameters</a></li> <li><a href="#snap-qc-metrics">Snap QC Metrics</a></li></ul></li> <li><a href="#snapcellbybin">SnapCellByBin</a></li> <li><a href="#makecompliantbam">MakeCompliantBAM</a></li> <li><a href="#breakoutsnap">BreakoutSnap</a></li></ul></li></ul></li> <li><a href="#outputs">Outputs</a></li> <li><a href="#running-on-terra">Running on Terra</a></li> <li><a href="#versioning">Versioning</a></li> <li><a href="#pipeline-improvements">Pipeline Improvements</a></li></ul> <p><img src="/warp/assets/img/scATAC_diagram.c52c8893.png" alt="scATAC_diagram"></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>The scATAC Pipeline was developed by the Broad DSP Pipelines team to process single cell/nucleus ATAC-seq datasets. The pipeline is based on the <a href="https://github.com/r3fang/SnapATAC" target="_blank" rel="noopener noreferrer">SnapATAC pipeline<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> described by <a href="https://www.biorxiv.org/content/10.1101/615179v2.full" target="_blank" rel="noopener noreferrer">Fang et al. (2019)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Overall, the pipeline uses the python module <a href="https://github.com/r3fang/SnapTools" target="_blank" rel="noopener noreferrer">SnapTools<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to align and process paired reads in the form of FASTQ files. It produces an hdf5-structured Snap file that includes a cell-by-bin count matrix. In addition to the Snap file, the final outputs include a GA4GH compliant aligned BAM and QC metrics.</p> <div class="custom-block tip"><p class="custom-block-title">Want to use the scATAC Pipeline for your publication?</p> <p>Check out the <a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/scatac.methods.html">scATAC Publication Methods</a> to get started!</p></div> <h3 id="quick-start-table"><a href="#quick-start-table" class="header-anchor">#</a> Quick Start Table</h3> <table><thead><tr><th>Pipeline Features</th> <th>Description</th> <th>Source</th></tr></thead> <tbody><tr><td>Assay Type</td> <td>Single nucleus ATAC-seq</td> <td><a href="https://www.biorxiv.org/content/biorxiv/early/2019/05/13/615179.full.pdf" target="_blank" rel="noopener noreferrer">Preprint here <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>Overall Workflow</td> <td>Generates Snap file with cell x bin matrix</td> <td>Code available from <a href="scATAC.wdl">GitHub</a></td></tr> <tr><td>Workflow Language</td> <td>WDL 1.0</td> <td><a href="https://github.com/openwdl/wdl" target="_blank" rel="noopener noreferrer">openWDL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>Aligner</td> <td>BWA</td> <td><a href="https://pubmed.ncbi.nlm.nih.gov/19451168/" target="_blank" rel="noopener noreferrer">Li H. and Durbin R., 2009<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>Data Input File Format</td> <td>File format in which sequencing data is provided</td> <td>Paired-end FASTQs with cell barcodes appended to read names (read barcode demultiplexing section <a href="https://github.com/r3fang/SnapATAC/wiki/FAQs#whatissnap" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</td></tr> <tr><td>Data Output File Format</td> <td>File formats in which scATAC output is provided</td> <td><a href="http://samtools.github.io/hts-specs/" target="_blank" rel="noopener noreferrer">BAM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://github.com/r3fang/SnapATAC/wiki/FAQs#whatissnap" target="_blank" rel="noopener noreferrer">Snap<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr></tbody></table> <h2 id="set-up"><a href="#set-up" class="header-anchor">#</a> Set-up</h2> <h3 id="workflow-installation-and-requirements"><a href="#workflow-installation-and-requirements" class="header-anchor">#</a> Workflow Installation and Requirements</h3> <p>The <a href="scATAC.wdl">scATAC workflow</a> is written in the Workflow Description Language WDL and can be downloaded by cloning the GitHub <a href="https://github.com/broadinstitute/warp/" target="_blank" rel="noopener noreferrer">WARP repository<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. The workflow can be deployed using <a href="https://cromwell.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">Cromwell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, a GA4GH compliant, flexible workflow management system that supports multiple computing platforms. For the latest workflow version and release notes, please see the scATAC <a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/scATAC.changelog.html">changelog</a>.</p> <h3 id="pipeline-inputs"><a href="#pipeline-inputs" class="header-anchor">#</a> Pipeline Inputs</h3> <p>The pipeline inputs are detailed in the table below. You can test the workflow by using the <a href="https://github.com/broadinstitute/warp/tree/master/pipelines/skylab/scATAC/example_inputs/human_example.json" target="_blank" rel="noopener noreferrer">human_example.json<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> example configuration file.</p> <table><thead><tr><th>Input name</th> <th>Input type</th> <th>Description</th></tr></thead> <tbody><tr><td>input_fastq1</td> <td>File</td> <td>FASTQ file of the first reads (R1)</td></tr> <tr><td>input_fastq2</td> <td>File</td> <td>FASTQ file of the second reads (R2)</td></tr> <tr><td>input_reference</td> <td>File</td> <td>Reference bundle that is generated with bwa-mk-index-wdl found <a href="https://github.com/HumanCellAtlas/skylab/blob/master/library/accessory_workflows/build_bwa_reference/bwa-mk-index.wdl" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>genome_name</td> <td>String</td> <td>Name of the genomic reference (name that precedes the “.tar” in the input_reference)</td></tr> <tr><td>output_bam</td> <td>String</td> <td>Name for the output BAM</td></tr> <tr><td>bin_size_list</td> <td>String</td> <td>List of bin sizes used to generate cell-by-bin matrices; default is 10000 bp</td></tr></tbody></table> <h3 id="input-file-preparation"><a href="#input-file-preparation" class="header-anchor">#</a> Input File Preparation</h3> <h4 id="r1-and-r2-fastq-preparation"><a href="#r1-and-r2-fastq-preparation" class="header-anchor">#</a> R1 and R2 FASTQ Preparation</h4> <p>The scATAC workflow requires paired reads in the form FASTQ files with the cell barcodes appended to the readnames. A description of the barcode demultiplexing can be found on the SnapATAC documentation (see barcode demultiplexing section <a href="https://github.com/r3fang/SnapATAC/wiki/FAQs#CEMBA_snap" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>). The full cell barcode must form the first part of the read name (for both R1 and R2 files) and be separated from the rest of the line by a colon. You can find an example python code to perform demultiplexing in the <a href="https://github.com/r3fang/SnapTools/blob/master/snaptools/dex_fastq.py" target="_blank" rel="noopener noreferrer">SnapTools documentation here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. The codeblock below demonstrates the correct format.</p> <div class="language- extra-class"><pre class="language-text"><code>@CAGTTGCACGTATAGAACAAGGATAGGATAAC:7001113:915:HJ535BCX2:1:1106:1139:1926 1:N:0:0
ACCCTCCGTGTGCCAGGAGATACCATGAATATGCCATAGAACCTGTCTCT
+
DDDDDIIIIIIIIIIIIIIHHIIIIIIIIIIIIIIIIIIIIIIIIIIIII
</code></pre></div><h4 id="input-reference-preparation"><a href="#input-reference-preparation" class="header-anchor">#</a> Input_reference Preparation</h4> <p>The input_reference is a BWA compatible reference bundle in TAR file format. You can create this BWA reference using the accessory workflow  <a href="https://github.com/HumanCellAtlas/skylab/blob/master/library/accessory_workflows/build_bwa_reference/bwa-mk-index.wdl" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h1 id="workflow-tasks-and-tools"><a href="#workflow-tasks-and-tools" class="header-anchor">#</a> Workflow Tasks and Tools</h1> <p>The <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/skylab/scATAC/scATAC.wdl" target="_blank" rel="noopener noreferrer">scATAC workflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is divided into multiple tasks which are described in the table below. The table also links to the Docker Image for each task and to the documentation or code for the relevant software tool parameters.</p> <table><thead><tr><th>Task</th> <th>Task Description</th> <th>Tool Docker Image</th> <th>Parameter Descriptions or Code</th></tr></thead> <tbody><tr><td>AlignPairedEnd</td> <td>Align the modified FASTQ files to the genome</td> <td><a href="https://github.com/broadinstitute/warp/blob/master/dockers/skylab/snaptools/Dockerfile" target="_blank" rel="noopener noreferrer">snaptools:0.0.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td><a href="https://github.com/r3fang/SnapTools" target="_blank" rel="noopener noreferrer">SnapTools documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>SnapPre</td> <td>Initial generation of snap file</td> <td><a href="https://github.com/broadinstitute/warp/blob/master/dockers/skylab/snaptools/Dockerfile" target="_blank" rel="noopener noreferrer">snaptools:0.0.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td><a href="https://github.com/r3fang/SnapTools" target="_blank" rel="noopener noreferrer">SnapTools documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>SnapCellByBin</td> <td>Binning of data by genomic bins</td> <td><a href="https://github.com/broadinstitute/warp/blob/master/dockers/skylab/snaptools/Dockerfile" target="_blank" rel="noopener noreferrer">snaptools:0.0.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td><a href="https://github.com/r3fang/SnapTools" target="_blank" rel="noopener noreferrer">SnapTools documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>MakeCompliantBAM</td> <td>Generation of a GA4GH compliant BAM</td> <td><a href="https://github.com/broadinstitute/warp/blob/master/dockers/skylab/snaptools/Dockerfile" target="_blank" rel="noopener noreferrer">snaptools:0.0.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td><a href="https://github.com/broadinstitute/warp/blob/master/dockers/skylab/snaptools/makeCompliantBAM.py" target="_blank" rel="noopener noreferrer">Code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>BreakoutSnap</td> <td>Extraction of tables from snap file into text format (for testing and user availability)</td> <td><a href="https://github.com/HumanCellAtlas/skylab/tree/master/docker/snap-breakout" target="_blank" rel="noopener noreferrer">snap-breakout:0.0.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td><a href="https://github.com/broadinstitute/warp/tree/master/dockers/skylab/snap-breakout/breakoutSnap.py" target="_blank" rel="noopener noreferrer">Code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr></tbody></table> <h3 id="task-summary"><a href="#task-summary" class="header-anchor">#</a> Task Summary</h3> <h4 id="alignpairedend"><a href="#alignpairedend" class="header-anchor">#</a> AlignPairedEnd</h4> <p>The AlignPairedEnd task takes the barcode demultiplexed FASTQ files and aligns reads to the genome using the BWA aligner. It uses the SnapTools min_cov parameter to set the minimum number of barcodes a fragment requires to be included in the final output. This parameter is set to 0. The final task output is an aligned BAM file.</p> <h4 id="snappre"><a href="#snappre" class="header-anchor">#</a> SnapPre</h4> <p>The SnapPre task uses SnapTools to perform preprocessing and filtering on the aligned BAM. The task outputs are a Snap file and QC metrics. The table below details the filtering parameters for the task.</p> <h5 id="filtering-parameters"><a href="#filtering-parameters" class="header-anchor">#</a> Filtering Parameters</h5> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Value</th></tr></thead> <tbody><tr><td>--min-mapq</td> <td>Fragments with mappability less than value will be filtered</td> <td>30</td></tr> <tr><td>--min-flen</td> <td>Fragments of length shorter than min_flen will be filtered</td> <td>0</td></tr> <tr><td>--max-flen</td> <td>Fragments of length bigger than min_flen will be filtered</td> <td>1000</td></tr> <tr><td>--keep-chrm</td> <td>Boolean variable indicates whether to keep reads mapped to chrM</td> <td>TRUE</td></tr> <tr><td>--keep-single</td> <td>Boolean variable indicates whether to keep single-end reads</td> <td>TRUE</td></tr> <tr><td>--keep-secondary</td> <td>Boolean variable indicates whether to keep secondary alignments</td> <td>FALSE</td></tr> <tr><td>--max-num</td> <td>Max number of barcodes to be stored. Based on the coverage, top max_barcode barcodes are selected and stored</td> <td>1000000</td></tr> <tr><td>--min-cov</td> <td>Fragments with less than min-cov number of barcodes will be filtered</td> <td>100</td></tr></tbody></table> <h4 id="snapcellbybin"><a href="#snapcellbybin" class="header-anchor">#</a> SnapCellByBin</h4> <p>The SnapCellByBin task uses the Snap file to create cell-by-bin count matrices in which a “1” represents a bin with an accessible region of the genome and a “0” represents an inaccessible region. The bin_size_list sets the bin size to 10,000 bp by default but can be changed by specifying the value in the inputs to the workflow.</p> <h4 id="makecompliantbam"><a href="#makecompliantbam" class="header-anchor">#</a> MakeCompliantBAM</h4> <p>The MakeCompliantBAM task uses a <a href="https://github.com/broadinstitute/warp/blob/master/dockers/skylab/snaptools/makeCompliantBAM.py" target="_blank" rel="noopener noreferrer">custom python script (here)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to make a GA4GH compliant BAM by moving the cellular barcodes in the read names to the CB tag.</p> <h4 id="breakoutsnap"><a href="#breakoutsnap" class="header-anchor">#</a> BreakoutSnap</h4> <p>The BreakoutSnap task extracts data from the Snap file and exports it to individual CSVs. These CSV outputs are listed in the table in the Outputs section below. The code is available <a href="https://github.com/broadinstitute/warp/tree/master/dockers/skylab/snap-breakout/breakoutSnap.py" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="outputs"><a href="#outputs" class="header-anchor">#</a> Outputs</h2> <p>The main outputs of the scATAC workflow are the Snap file, Snap QC metrics, and the GA4GH compliant BAM file. All files with the prefix “breakout” are CSV files containing individual pieces of data from the Snap. The sessions for the Snap file are described in the <a href="https://github.com/r3fang/SnapTools" target="_blank" rel="noopener noreferrer">SnapTools documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Additionally, you can read detailed information on the <a href="https://github.com/r3fang/SnapTools/blob/master/docs/snap_format.docx" target="_blank" rel="noopener noreferrer">Snap file fields for each session<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (select &quot;View Raw&quot;).</p> <table><thead><tr><th>Output File Name</th> <th>Description</th></tr></thead> <tbody><tr><td>output_snap_qc</td> <td>Quality control file corresponding to the snap file</td></tr> <tr><td>output_snap</td> <td>Output snap file (in hdf5 container format)</td></tr> <tr><td>output_aligned_bam</td> <td>Output BAM file, compliant with GA4GH standards</td></tr> <tr><td>breakout_barcodes</td> <td>Text file containing the FM ('Fragment session') barcodeLen and barcodePos fields</td></tr> <tr><td>breakout_fragments</td> <td>Text file containing the FM ('Fragments session') fragChrom, fragLen, and fragStart fields</td></tr> <tr><td>breakout_binCoordinates</td> <td>Text file with the AM session ('Cell x bin accessibility' matrix) binChrom and binStart fields</td></tr> <tr><td>breakout_binCounts</td> <td>Text file with the AM session ('Cell x bin accessibility' matrix) idx, idy, and count fields</td></tr> <tr><td>breakout_barcodesSection</td> <td>Text file with the data from the BD session ('Barcode session' table)</td></tr></tbody></table> <h5 id="snap-qc-metrics"><a href="#snap-qc-metrics" class="header-anchor">#</a> Snap QC Metrics</h5> <p>The following table details the metrics available in the output_snap_qc file.</p> <table><thead><tr><th>QC Metric</th> <th>Abbreviation</th></tr></thead> <tbody><tr><td>Total number of unique barcodes</td> <td>No abbreviation</td></tr> <tr><td>Total number of fragments</td> <td>TN</td></tr> <tr><td>Total number of uniquely mapped</td> <td>UM</td></tr> <tr><td>Total number of single ends</td> <td>SE</td></tr> <tr><td>Total number of secondary alignments</td> <td>SA</td></tr> <tr><td>Total number of paired ends</td> <td>PE</td></tr> <tr><td>Total number of proper paired</td> <td>PP</td></tr> <tr><td>Total number of proper frag len</td> <td>PL</td></tr> <tr><td>Total number of usable fragments</td> <td>US</td></tr> <tr><td>Total number of unique fragments</td> <td>UQ</td></tr> <tr><td>Total number of chrM fragments</td> <td>CM</td></tr></tbody></table> <h2 id="running-on-terra"><a href="#running-on-terra" class="header-anchor">#</a> Running on Terra</h2> <p><a href="https://app.terra.bio/" target="_blank" rel="noopener noreferrer">Terra<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is a public, cloud-based platform for biomedical research. If you would like to try the scATAC workflow (previously named &quot;snap-atac&quot;) in Terra, you can import the most recent version from <a href="https://dockstore.org/workflows/github.com/broadinstitute/warp/scATAC:scATAC_v1.1.0?tab=info" target="_blank" rel="noopener noreferrer">Dockstore<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Additionally, there is a public <a href="https://app.terra.bio/#workspaces/brain-initiative-bcdc/scATAC" target="_blank" rel="noopener noreferrer">scATAC workspace<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> preloaded with the scATAC workflow and downsampled data.</p> <h2 id="versioning"><a href="#versioning" class="header-anchor">#</a> Versioning</h2> <p>All scATAC workflow releases are documented in the <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/skylab/scATAC/scATAC.changelog.md" target="_blank" rel="noopener noreferrer">scATAC changelog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="pipeline-improvements"><a href="#pipeline-improvements" class="header-anchor">#</a> Pipeline Improvements</h2> <p>Please help us make our tools better by contacting <a href="mailto:kdegatano@broadinstitute.org">Kylee Degatano</a> for pipeline-related suggestions or questions.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/broadinstitute/warp/edit/master/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/21/2020, 4:37:30 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/warp/documentation/Pipelines/CEMBA_MethylC_Seq_Pipeline/" class="prev">
        CEMBA Pipeline Overview
      </a></span> <span class="next"><a href="/warp/documentation/Pipelines/Single_Cell_ATAC_Seq_Pipeline/scatac.methods.html">
        scATAC v1.1.0 Methods
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/warp/assets/js/app.6148946b.js" defer></script><script src="/warp/assets/js/2.3c82beca.js" defer></script><script src="/warp/assets/js/10.2568daf3.js" defer></script>
  </body>
</html>
