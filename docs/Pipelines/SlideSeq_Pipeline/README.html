<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Pipelines/SlideSeq_Pipeline/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Slide-seq Overview | WARP</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://broadinstitute.github.io/warp/docs/Pipelines/SlideSeq_Pipeline/README"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Slide-seq Overview | WARP"><meta data-rh="true" name="description" content="| Pipeline Version | Date Updated | Documentation Author | Questions or Feedback |"><meta data-rh="true" property="og:description" content="| Pipeline Version | Date Updated | Documentation Author | Questions or Feedback |"><link data-rh="true" rel="icon" href="/warp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://broadinstitute.github.io/warp/docs/Pipelines/SlideSeq_Pipeline/README"><link data-rh="true" rel="alternate" href="https://broadinstitute.github.io/warp/docs/Pipelines/SlideSeq_Pipeline/README" hreflang="en"><link data-rh="true" rel="alternate" href="https://broadinstitute.github.io/warp/docs/Pipelines/SlideSeq_Pipeline/README" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BX0CVVQ6KQ-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/warp/blog/rss.xml" title="WARP RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/warp/blog/atom.xml" title="WARP Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZ4BLRHQYS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NZ4BLRHQYS",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="WARP" href="/warp/opensearch.xml">
<script>!function(t,h,e,j,s,n){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:2427684,hjsv:6},s=h.getElementsByTagName("head")[0],(n=h.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,s.appendChild(n)}(window,document)</script><link rel="stylesheet" href="/warp/assets/css/styles.ddc3fdb8.css">
<link rel="preload" href="/warp/assets/js/runtime~main.4d6b11e4.js" as="script">
<link rel="preload" href="/warp/assets/js/main.845a3bc9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/warp/"><b class="navbar__title text--truncate">WARP Pipelines</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/warp/docs/get-started">Documentation</a><a class="navbar__item navbar__link" href="/warp/blog">Blog</a><a href="https://github.com/broadinstitute/warp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/warp/docs/get-started">Welcome to WARP</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/warp/docs/About_WARP/BestPractices">About WARP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/warp/docs/Pipelines/ATAC/README">WARP Pipelines</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/ATAC/README">ATAC</a><button aria-label="Toggle the collapsible sidebar category &#x27;ATAC&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/BuildIndices_Pipeline/README">BuildIndices</a><button aria-label="Toggle the collapsible sidebar category &#x27;BuildIndices&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Exome_Germline_Single_Sample_Pipeline/README">Exome Germline Single Sample</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exome Germline Single Sample&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Illumina_Genotyping_Arrays_Pipeline/README">Illumina Genotyping Array</a><button aria-label="Toggle the collapsible sidebar category &#x27;Illumina Genotyping Array&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/ImputationBeagle_Pipeline/README">ImputationBeagle</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Imputation_Pipeline/README">Imputation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Imputation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/JointGenotyping_Pipeline/README">JointGenotyping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/Multiome_Pipeline/README">Multiome scATAC and GEX</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Optimus_Pipeline/README">Optimus</a><button aria-label="Toggle the collapsible sidebar category &#x27;Optimus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/PairedTag_Pipeline/README">Paired-Tag</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/RNA_with_UMIs_Pipeline/README">RNA with UMIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;RNA with UMIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/warp/docs/Pipelines/SlideSeq_Pipeline/README">Slide-seq</a><button aria-label="Toggle the collapsible sidebar category &#x27;Slide-seq&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/SlideSeq_Pipeline/count-matrix-overview">Slide-seq Count Matrix Overview</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/SlideTags_Pipeline/README">Slide-tags</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Smart-seq2_Single_Nucleus_Multi_Sample_Pipeline/README">Smart-seq2 Single Nucleus Multi-Sample</a><button aria-label="Toggle the collapsible sidebar category &#x27;Smart-seq2 Single Nucleus Multi-Sample&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/snm3C/README">Single Nucleus Methyl-Seq and Chromatin Capture</a><button aria-label="Toggle the collapsible sidebar category &#x27;Single Nucleus Methyl-Seq and Chromatin Capture&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/Ultima_Genomics_Whole_Genome_Germline_Pipeline/README">Ultima Genomics Whole Genome Germline</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Whole_Genome_Germline_Single_Sample_Pipeline/README">Whole Genome Germline Single Sample</a><button aria-label="Toggle the collapsible sidebar category &#x27;Whole Genome Germline Single Sample&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/warp/docs/Best_practices/GC_cost_optimization">WDL Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/warp/docs/Pipelines/CEMBA_MethylC_Seq_Pipeline/README">Deprecated Pipelines</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/warp/docs/contribution/README">Contribution Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Contribution Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/warp/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">WARP Pipelines</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Slide-seq</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Slide-seq Overview</h1><table><thead><tr><th align="center">Pipeline Version</th><th align="center">Date Updated</th><th align="center">Documentation Author</th><th align="center">Questions or Feedback</th></tr></thead><tbody><tr><td align="center"><a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer">SlideSeq v3.4.2</a></td><td align="center">September, 2024</td><td align="center">Elizabeth Kiernan &amp; Kaylee Mathews</td><td align="center">Please <a href="https://github.com/broadinstitute/warp/issues" target="_blank" rel="noopener noreferrer">file an issue in WARP</a>.</td></tr></tbody></table><p><img loading="lazy" alt="SlideSeq_diagram" src="/warp/assets/images/slide-seq_diagram-124fb3cf31b065e508227f5e006054ec.png" width="1520" height="2208" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-the-slide-seq-workflow">Introduction to the Slide-seq workflow<a href="#introduction-to-the-slide-seq-workflow" class="hash-link" aria-label="Direct link to Introduction to the Slide-seq workflow" title="Direct link to Introduction to the Slide-seq workflow">​</a></h2><p>The <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/wdl/slideseq/SlideSeq.wdl" target="_blank" rel="noopener noreferrer">Slide-seq workflow</a> is an open-source, cloud-optimized pipeline developed in collaboration with the <a href="https://biccn.org/" target="_blank" rel="noopener noreferrer">BRAIN Initiative Cell Census Network</a> (BICCN) and the BRAIN Initiative Cell Atlas Network (BICAN). It supports the processing of spatial transcriptomic data generated with the <a href="https://www.science.org/doi/10.1126/science.aaw1219" target="_blank" rel="noopener noreferrer">Slide-seq</a> (commercialized as <a href="https://curiobioscience.com/seeker/" target="_blank" rel="noopener noreferrer">Curio Seeker</a>) assay.</p><p>Overall, the workflow corrects bead barcodes, aligns reads to the genome, generates a count matrix, calculates summary metrics for genes, barcodes, and UMIs, returns read outputs in BAM format, and returns counts in numpy matrix and h5ad file formats.</p><p>Slide-seq has been validated for analyzing mouse datasets generated with the Slide-seq assay. Learn more in the <a href="#validation-against-on-prem-pipeline">validation section</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="where-did-the-pipeline-come-from">Where did the pipeline come from?<a href="#where-did-the-pipeline-come-from" class="hash-link" aria-label="Direct link to Where did the pipeline come from?" title="Direct link to Where did the pipeline come from?">​</a></h4><p>The Broad Pipelines Development team worked closely with members of the Evan Macosko Laboratory to adapt an on-premise pipeline into the cloud-based Slide-seq pipeline described here. Thank you to James Webber, Jonah Langlieb, Nina Sachdev, and the rest of the Evan Macosko Lab for their commitment to <a href="https://www.nature.com/articles/sdata201618" target="_blank" rel="noopener noreferrer">FAIR Principles</a> and for helping create the cloud-based Slide-seq pipeline.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="quickstart-table">Quickstart table<a href="#quickstart-table" class="hash-link" aria-label="Direct link to Quickstart table" title="Direct link to Quickstart table">​</a></h2><p>The following table provides a quick glance at the Slide-seq pipeline features:</p><table><thead><tr><th>Pipeline features</th><th>Description</th><th>Source</th></tr></thead><tbody><tr><td>Assay type</td><td>Slide-seq</td><td><a href="https://www.science.org/doi/10.1126/science.aaw1219" target="_blank" rel="noopener noreferrer">Rodriques et al. 2019</a></td></tr><tr><td>Overall workflow</td><td>Quality control and transcriptome quantification module</td><td>Code available from <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/wdl/slideseq/SlideSeq.wdl" target="_blank" rel="noopener noreferrer">GitHub</a></td></tr><tr><td>Workflow language</td><td>WDL 1.0</td><td><a href="https://github.com/openwdl/wdl" target="_blank" rel="noopener noreferrer">openWDL</a></td></tr><tr><td>Genomic Reference Sequence</td><td>M23 (GRCm38.p6) mouse genome primary sequence</td><td>GENCODE <a href="https://www.gencodegenes.org/mouse/release_M23.html" target="_blank" rel="noopener noreferrer">mouse reference files</a></td></tr><tr><td>Transcriptomic reference annotation</td><td>M23 mouse transcriptome built with the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/wdl/build_indices/BuildIndices.wdl" target="_blank" rel="noopener noreferrer">BuildIndices workflow</a></td><td>GENCODE <a href="https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_mouse/release_M23/gencode.vM23.annotation.gff3.gz" target="_blank" rel="noopener noreferrer">mouse GTF</a>; <a href="https://console.cloud.google.com/storage/browser/_details/gcp-public-data--broad-references/mm10/v0/single_nucleus/star/modified_star_2.7.9a_primary_gencode_mouse_vM23.tar;tab=live_object" target="_blank" rel="noopener noreferrer">modified version</a> available in Broad’s public reference bucket</td></tr><tr><td>Aligner and transcript quantification</td><td>STARsolo</td><td><a href="https://www.biorxiv.org/content/10.1101/2021.05.05.442755v1" target="_blank" rel="noopener noreferrer">Kaminow et al. 2021</a></td></tr><tr><td>Data input file format</td><td>File format in which sequencing data is provided</td><td><a href="https://academic.oup.com/nar/article/38/6/1767/3112533" target="_blank" rel="noopener noreferrer">FASTQ</a></td></tr><tr><td>Data output file format</td><td>File formats in which Slide-seq output is provided</td><td><a href="http://samtools.github.io/hts-specs/" target="_blank" rel="noopener noreferrer">BAM</a>, Python NumPy arrays, and h5ad</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up">Set-up<a href="#set-up" class="hash-link" aria-label="Direct link to Set-up" title="Direct link to Set-up">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="slide-seq-installation">Slide-seq installation<a href="#slide-seq-installation" class="hash-link" aria-label="Direct link to Slide-seq installation" title="Direct link to Slide-seq installation">​</a></h3><p>To download the latest Slide-seq release, see the release tags prefixed with &quot;SlideSeq&quot; on the WARP <a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer">releases page</a>. All Slide-seq pipeline releases are documented in the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/wdl/slideseq/SlideSeq.changelog.md" target="_blank" rel="noopener noreferrer">Slide-seq changelog</a>. </p><p>To search releases of this and other pipelines, use the WARP command-line tool <a href="https://github.com/broadinstitute/warp/tree/master/wreleaser" target="_blank" rel="noopener noreferrer">Wreleaser</a>.</p><p>If you’re running a Slide-seq workflow version prior to the latest release, the accompanying documentation for that release may be downloaded with the source code on the WARP <a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer">releases page</a> (see the source code folder <code>website/docs/Pipelines/SlideSeq_Pipeline</code>).</p><p>The Slide-seq pipeline can be deployed using <a href="https://cromwell.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">Cromwell</a>, a GA4GH compliant, flexible workflow management system that supports multiple computing platforms. The workflow can also be run in <a href="https://app.terra.bio" target="_blank" rel="noopener noreferrer">Terra</a>, a cloud-based analysis platform. The <a href="https://app.terra.bio/#workspaces/warp-pipelines/Slide-seq" target="_blank" rel="noopener noreferrer">Slide-seq public workspace</a> on Terra contains the Slide-seq workflow, workflow configuration, required reference data and other inputs, and example testing data.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="inputs">Inputs<a href="#inputs" class="hash-link" aria-label="Direct link to Inputs" title="Direct link to Inputs">​</a></h3><p>The Slide-seq workflow inputs are specified in JSON configuration files. Example configuration files can be found in the <a href="https://github.com/broadinstitute/warp/tree/master/pipelines/wdl/slideseq/test_inputs" target="_blank" rel="noopener noreferrer">test_inputs</a> folder in the WARP repository.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="input-descriptions">Input descriptions<a href="#input-descriptions" class="hash-link" aria-label="Direct link to Input descriptions" title="Direct link to Input descriptions">​</a></h4><table><thead><tr><th>Parameter name</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>r1_fastq</td><td>Array of Read 1 FASTQ files split across multiple sequencing lanes; forward reads containing bead barcodes and Unique Molecular Identifiers (UMIs); order of files must match the <code>r2_fastq</code> array.</td><td>Array<!-- -->[File]</td></tr><tr><td>r2_fastq</td><td>Array of Read 2 FASTQ files split across multiple sequencing lanes; reverse reads containing the cDNA fragment generated from captured mRNA; order of files must match the <code>r1_fastq</code> array.</td><td>Array<!-- -->[File]</td></tr><tr><td>i1_fastq</td><td>Optional array of i1 (index) FASTQ files; index reads used for demultiplexing of multiple samples on one flow cell.</td><td>Array<!-- -->[File]</td></tr><tr><td>input_id</td><td>Unique identifier describing the biological sample or replicate that corresponds with the FASTQ files; inserted into read group header and used to name output files.</td><td>String</td></tr><tr><td>read_structure</td><td>Description of the UMI (M) and Barcode (C) positions in the Read 1 FASTQ; used to trim spacer sequences (X) for use by STARsolo; ex. &quot;8C18X6C9M1X&quot;.</td><td>String</td></tr><tr><td>tar_star_reference</td><td>TAR file containing a species-specific reference genome and GTF; generated using the <a href="https://github.com/broadinstitute/warp/tree/master/pipelines/wdl/build_indices/BuildIndices.wdl" target="_blank" rel="noopener noreferrer">BuildIndices workflow</a>.</td><td>File</td></tr><tr><td>annotations_gtf</td><td>GTF containing gene annotations used for gene tagging (must match GTF in STAR reference).</td><td>File</td></tr><tr><td>output_bam_basename</td><td>Optional string used for the output BAM file basename.</td><td>String</td></tr><tr><td>count_exons</td><td>Optional boolean indicating if the workflow should calculate exon counts; default is set to “true” and produces an h5ad file containing both whole-gene counts and exon counts in an additional layer; when set to “false”, an h5ad file containing only whole-gene counts is produced.</td><td>Boolean</td></tr><tr><td>bead_locations</td><td>Whitelist TSV file containing bead barcodes and XY coordinates on a single line for each bead; determined by sequencing prior to mRNA transfer and library preparation.</td><td>File</td></tr><tr><td>cloud_provider</td><td>String describing the cloud provider that should be used to run the workflow; value should be &quot;gcp&quot; or &quot;azure&quot;.</td><td>String</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="pseudogene-handling">Pseudogene handling<a href="#pseudogene-handling" class="hash-link" aria-label="Direct link to Pseudogene handling" title="Direct link to Pseudogene handling">​</a></h4><p>The example Slide-seq reference files are created using the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/wdl/build_indices/BuildIndices.wdl" target="_blank" rel="noopener noreferrer">BuildIndices pipeline</a>. The BuildIndices pipeline modifies a given GTF downloaded from GENCODE to only include biotypes that are listed in a tab separated file (<a href="https://github.com/broadinstitute/warp-tools/blob/develop/3rd-party-tools/build-indices/Biotypes.tsv" target="_blank" rel="noopener noreferrer">biotypes.tsv</a>). The example references do not include the pseudogene biotype. Learn more about Ensembl biotypes in the <a href="https://m.ensembl.org/info/genome/genebuild/biotypes.html" target="_blank" rel="noopener noreferrer">Ensembl overview</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sample-inputs-for-analyses-in-a-terra-workspace">Sample inputs for analyses in a Terra Workspace<a href="#sample-inputs-for-analyses-in-a-terra-workspace" class="hash-link" aria-label="Direct link to Sample inputs for analyses in a Terra Workspace" title="Direct link to Sample inputs for analyses in a Terra Workspace">​</a></h4><p>The Slide-seq pipeline is currently available on the cloud-based platform Terra. After registering, you can access the <a href="https://app.terra.bio/#workspaces/warp-pipelines/Slide-seq" target="_blank" rel="noopener noreferrer">Slide-seq public workspace</a> which is preloaded with instructions and sample data. Please view the <a href="https://support.terra.bio/hc/en-us" target="_blank" rel="noopener noreferrer">Support Center</a> for more information on using the Terra platform.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="slide-seq-tasks-and-tools">Slide-seq tasks and tools<a href="#slide-seq-tasks-and-tools" class="hash-link" aria-label="Direct link to Slide-seq tasks and tools" title="Direct link to Slide-seq tasks and tools">​</a></h2><p>The <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/wdl/slideseq/SlideSeq.wdl" target="_blank" rel="noopener noreferrer">Slide-seq workflow</a> imports individual &quot;tasks,&quot; also written in WDL script, from the WARP <a href="https://github.com/broadinstitute/warp/tree/develop/tasks/wdl" target="_blank" rel="noopener noreferrer">tasks folder</a>. </p><p>Overall, the Slide-seq workflow:</p><ol><li>Calculates prealignment metrics.</li><li>Filters, trims, and splits reads into &lt; 30 GB FASTQs.</li><li>Uses STARsolo to correct bead barcodes, align reads, and count genes.</li><li>Calculates metrics.</li><li>Merges the STAR outputs into NPY and NPZ arrays.</li><li>Merges gene counts and metrics into a h5ad-formatted matrix.</li></ol><p>The tools each Slide-seq task employs are detailed in the table below. </p><p>To see specific tool parameters, select the task WDL link in the table; then find the task and view the <code>command {}</code> section of the task in the WDL script. To view or use the exact tool software, see the task&#x27;s Docker image which is specified in the task WDL <code># runtime values</code> section as <code>String docker =</code>.</p><table><thead><tr><th>Task name and WDL link</th><th>Tool</th><th>Software</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/Metrics.wdl" target="_blank" rel="noopener noreferrer">Metrics.FastqMetricsSlideSeq (alias = FastqMetrics)</a></td><td>fastq_metrics</td><td><a href="https://github.com/broadinstitute/warp-tools" target="_blank" rel="noopener noreferrer">warp-tools</a></td><td>Calculates prealignment metrics from the input FASTQ files. Outputs metrics files including the bead barcode distribution, UMI distribution, number of reads per cell and number of UMIs per cell.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/FastqProcessing.wdl" target="_blank" rel="noopener noreferrer">FastqProcessing.FastqProcessingSlidSeq (alias = SplitFastq)</a></td><td>fastq_slideseq</td><td><a href="https://github.com/broadinstitute/warp-tools" target="_blank" rel="noopener noreferrer">warp-tools</a></td><td>Filters reads, trims bead barcodes in read 1 to remove spacer sequences, and partitions the input FASTQ files by bead barcode to create an array of FASTQ files that are each ~ 30 GB. The function keeps all reads belonging to the same bead barcode in the same partitioned FASTQ file.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/StarAlign.wdl" target="_blank" rel="noopener noreferrer">StarAlign.STARsoloFastqSlideSeq (alias = STARsoloFastqSlideSeq)</a></td><td>STARsolo</td><td><a href="https://github.com/alexdobin/STAR" target="_blank" rel="noopener noreferrer">STAR</a></td><td>For each of the partitioned FASTQ files, performs bead barcode correction, poly(A) tail trimming from adapters, alignment, gene annotation, and gene counting. Produces a count matrix and BAM file for each partition.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/MergeSortBam.wdl" target="_blank" rel="noopener noreferrer">Merge.MergeSortBamFiles (alias= MergeBam)</a></td><td>MergeSamFiles</td><td><a href="https://broadinstitute.github.io/picard/" target="_blank" rel="noopener noreferrer">Picard</a></td><td>Merges the array of BAM files into a single BAM and sorts in coordinate order.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/Metrics.wdl" target="_blank" rel="noopener noreferrer">Metrics.CalculateGeneMetrics (alias = GeneMetrics)</a></td><td>TagSort</td><td><a href="https://github.com/broadinstitute/warp-tools" target="_blank" rel="noopener noreferrer">warp-tools</a></td><td>Sorts the BAM file by gene using the bead barcode (CB), molecule barcode (UB), and gene ID (GX) tags and computes gene metrics.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/Metrics.wdl" target="_blank" rel="noopener noreferrer">Metrics.CalculateUMIsMetrics (alias = UMIsMetrics)</a></td><td>TagSort</td><td><a href="https://github.com/broadinstitute/warp-tools" target="_blank" rel="noopener noreferrer">warp-tools</a></td><td>Sorts the BAM file by gene using the bead barcode (CB), molecule barcode (UB), and gene ID (GX) tags and computes gene metrics.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/Metrics.wdl" target="_blank" rel="noopener noreferrer">Metrics.CalculateCellMetrics (alias = CellMetrics)</a></td><td>TagSort</td><td><a href="https://github.com/broadinstitute/warp-tools" target="_blank" rel="noopener noreferrer">warp-tools</a></td><td>Sorts the BAM file by bead barcode (CB), molecule barcode (UB), and gene ID (GX) tags and computes bead barcode metrics.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/StarAlign.wdl" target="_blank" rel="noopener noreferrer">StarAlign.MergeStarOutput (alias = MergeStarOutputsExons)</a></td><td>create-npz-output.py</td><td><a href="https://www.python.org/" target="_blank" rel="noopener noreferrer">Python 3</a></td><td>Creates a compressed raw NPY or NPZ file containing the STARsolo output features (NPY), barcodes (NPZ) and counts (NPZ). By default, <code>count_exons</code> is true and exon counts are included in output files. When <code>count_exons</code> is false, exon counts are excluded.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/H5adUtils.wdl" target="_blank" rel="noopener noreferrer">H5adUtils.SingleNucleusOptimusH5adOutput (alias = OptimusH5adGenerationWithExons)</a></td><td>create_h5ad_optimus.py</td><td><a href="https://www.python.org/" target="_blank" rel="noopener noreferrer">Python 3</a></td><td>Merges the gene counts, bead barcode metrics, and gene metrics data into an h5ad formatted bead-by-gene matrix. By default, the h5ad file contains whole-gene counts with exon counts in an additional layer. When <code>count_exons</code> is false, the task is run as <code>SlideseqH5adGeneration</code> and exon counts are excluded.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-calculating-prealignment-metrics">1. Calculating prealignment metrics<a href="#1-calculating-prealignment-metrics" class="hash-link" aria-label="Direct link to 1. Calculating prealignment metrics" title="Direct link to 1. Calculating prealignment metrics">​</a></h4><p>The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/FastqProcessing.wdl" target="_blank" rel="noopener noreferrer">FastqMetricsSlideSeq</a> task calculates prealignment metrics used for assessing data quality from the input FASTQ files. These metrics include the bead barcode distribution,  UMI distribution, number of reads per cell and number of UMIs per cell. These metrics are included in the final outputs of the workflow. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-filtering-reads-trimming-barcodes-and-splitting-fastqs">2. Filtering reads, trimming barcodes, and splitting FASTQs<a href="#2-filtering-reads-trimming-barcodes-and-splitting-fastqs" class="hash-link" aria-label="Direct link to 2. Filtering reads, trimming barcodes, and splitting FASTQs" title="Direct link to 2. Filtering reads, trimming barcodes, and splitting FASTQs">​</a></h4><p><strong>Read filtering</strong></p><p>Although the function of the bead barcodes is to identify the spatial location of gene expression in the tissue, barcode errors can arise during sequencing that make it difficult to assign reads to the proper location. </p><p>The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/FastqProcessing.wdl" target="_blank" rel="noopener noreferrer">FastqProcessingSlidSeq</a> task uses <a href="https://github.com/broadinstitute/warp-tools" target="_blank" rel="noopener noreferrer">warp-tools</a> to evaluate barcode errors by comparing the Read 1 FASTQ sequences against a whitelist of barcodes created by sequencing prior to the mRNA transfer and library preparation steps of the <a href="https://www.science.org/doi/10.1126/science.aaw1219" target="_blank" rel="noopener noreferrer">Slide-Seq</a> protocol.</p><p>Barcodes that are more than one edit distance (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5410656/" target="_blank" rel="noopener noreferrer">Hamming distance</a>) from any of the barcode sequences in the whitelist are filtered at this step and not included in the output. The remaining barcodes are corrected by the <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/StarAlign.wdl" target="_blank" rel="noopener noreferrer">STARsoloFastqSlideSeq</a> task.</p><p><strong>Barcode trimming</strong></p><p>The task uses warp-tools to trim spacer sequences from bead barcodes and UMIs for use by STARsolo, which requires continuous sample barcodes without spacer sequences between them. The input <code>read_structure</code> is used to parse the barcodes and remove any bases with tags other than C or M, which represent the bead barcode and UMI, respectively. For example, with a <code>read_structure</code> of 8C18X6C9M1X, bases represented by 18X and 1X are removed from the reads and the string of bases is rewritten with the structure 14C9M. Bases represented by tags other than X will also be removed during this step, so long as they are not C or M.</p><p><strong>FASTQ splitting</strong></p><p>For faster processing of large datasets, the task divides the input array of FASTQ files into multiple FASTQs, each containing reads from the same bead barcodes such that the FASTQ files are approximately 30 GB in size. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-correcting-bead-barcodes-trimming-and-aligning-reads-and-counting-genes-with-starsolo">3. Correcting bead barcodes, trimming and aligning reads, and counting genes with STARsolo<a href="#3-correcting-bead-barcodes-trimming-and-aligning-reads-and-counting-genes-with-starsolo" class="hash-link" aria-label="Direct link to 3. Correcting bead barcodes, trimming and aligning reads, and counting genes with STARsolo" title="Direct link to 3. Correcting bead barcodes, trimming and aligning reads, and counting genes with STARsolo">​</a></h4><p><strong>Bead barcode correction</strong></p><p>The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/StarAlign.wdl" target="_blank" rel="noopener noreferrer">STARsoloFastqSlideSeq</a> task uses the STAR aligner to evaluate barcode errors by comparing the Read 1 FASTQ sequences against a whitelist of barcodes created by sequencing prior to the mRNA transfer and library preparation steps of the <a href="https://www.science.org/doi/10.1126/science.aaw1219" target="_blank" rel="noopener noreferrer">Slide-seq</a> protocol.</p><p>Corrected barcodes are those that fall within one edit distance (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5410656/" target="_blank" rel="noopener noreferrer">Hamming distance</a>) of one of the barcode sequences in the whitelist. Note that prior to running STARsolo, uncorrectable barcodes (with more than one mismatch) are filtered out by the <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/FastqProcessing.wdl" target="_blank" rel="noopener noreferrer">FastqProcessingSlidSeq</a> task.</p><p><strong>Read trimming</strong></p><p>Poly(A) tails are trimmed from reads using the STARsolo parameter <code>--clip3pAdapterSeq AAAAAA</code>.</p><p><strong>Alignment</strong></p><p>STAR maps barcoded reads to the genome primary assembly reference (see the <a href="#quickstart-table">Quickstart table</a> above for version information). The example references for the Slide-seq workflow were generated using the <a href="https://github.com/broadinstitute/warp/tree/master/pipelines/wdl/build_indices/BuildIndices.wdl" target="_blank" rel="noopener noreferrer">BuildIndices pipeline</a>.</p><p><strong>Gene annotation and counting</strong></p><p>Prior to gene counting, STARsolo adds gene annotations which will vary depending on the value of <code>count_exons</code>. By default, <code>count_exons</code> is true and STARsolo will run with the parameter <code>--soloFeatures Gene GeneFull</code> to produce both whole-gene and exon counts. If <code>count_exons</code> is false, STARsolo will run with the parameter <code>--soloFeatures GeneFull</code> to produce whole-gene counts.</p><p>The resulting BAM files are merged together into a single BAM using the <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/MergeSortBam.wdl" target="_blank" rel="noopener noreferrer">MergeSortBamFiles</a> task.</p><p><strong>STARsolo outputs</strong></p><p>The task’s output includes a coordinate-sorted BAM file containing the bead barcode-corrected reads and SAM attributes UB UR UY CR CB CY NH GX GN. Additionally, after counting, the task outputs three intermediate TSV files (features, barcodes, and matrix) used for downstream h5ad matrix generation.   </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-calculating-metrics">4. Calculating metrics<a href="#4-calculating-metrics" class="hash-link" aria-label="Direct link to 4. Calculating metrics" title="Direct link to 4. Calculating metrics">​</a></h4><p>The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/Metrics.wdl" target="_blank" rel="noopener noreferrer">CalculateGeneMetrics</a>, <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/Metrics.wdl" target="_blank" rel="noopener noreferrer">CalculateUMIsMetrics</a>, and <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/Metrics.wdl" target="_blank" rel="noopener noreferrer">CalculateCellMetrics</a> tasks use <a href="https://github.com/broadinstitute/warp-tools" target="_blank" rel="noopener noreferrer">warp-tools</a> to calculate summary metrics that help assess the per-bead and per-UMI quality of the data output each time this pipeline is run. </p><p>These metrics output from both tasks are included in the output h5ad matrix. A detailed list of these metrics is found in the <a href="/warp/docs/Pipelines/SlideSeq_Pipeline/count-matrix-overview">Slide-seq Count Matrix Overview</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-merging-the-star-outputs-into-npy-and-npz-arrays">5. Merging the STAR outputs into NPY and NPZ arrays<a href="#5-merging-the-star-outputs-into-npy-and-npz-arrays" class="hash-link" aria-label="Direct link to 5. Merging the STAR outputs into NPY and NPZ arrays" title="Direct link to 5. Merging the STAR outputs into NPY and NPZ arrays">​</a></h4><p>The STARsolo output includes a features, barcodes, and matrix TSV for each of the partitioned FASTQ input files. The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/StarAlign.wdl" target="_blank" rel="noopener noreferrer">MergeStarOutput task</a> merges each respective TSV. It uses a custom python script to convert the merged matrix, features, and barcodes output from STARsolo into an NPY (features and barcodes)- and NPZ (the matrix)-formatted file.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-merging-counts-and-metrics-data-into-h5ad-formatted-matrix">6. Merging counts and metrics data into h5ad-formatted matrix<a href="#6-merging-counts-and-metrics-data-into-h5ad-formatted-matrix" class="hash-link" aria-label="Direct link to 6. Merging counts and metrics data into h5ad-formatted matrix" title="Direct link to 6. Merging counts and metrics data into h5ad-formatted matrix">​</a></h4><p>The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/wdl/H5adUtils.wdl" target="_blank" rel="noopener noreferrer">SingleNucleusOptimusH5adOutput</a> task uses a custom python script to merge the converted STARsolo count matrix and the cell (bead) and gene metrics into an h5ad-formatted bead-by-gene matrix. <strong>These counts are raw and unfiltered.</strong></p><p>Read full details for all the metrics in the <a href="/warp/docs/Pipelines/SlideSeq_Pipeline/count-matrix-overview">Slide-seq Count Matrix Overview</a>.</p><p><strong>Gene counts</strong></p><p>The type of gene counts in the h5ad file will vary depending on the value of the Slide-seq workflow input, <code>count_exons</code>. By default, <code>count_exons</code> is set to true and the output h5ad file will contain whole-gene counts with exon counts in an additional layer.</p><p>If the workflow is run with <code>count_exons</code> set to false, the output h5ad file will contain whole-gene counts. Running the workflow in this configuration will cause the h5ad matrix to have fewer columns (bead barcodes) due to the difference in STARsolo counting mode.</p><p>You can determine which type of counts are in the h5ad by looking at the global attribute <code>expression_data_type</code>.</p><p>After running the pipeline with <code>count_exons</code> set to true, you can access whole-gene and exonic counts using the AnnData <code>layers()</code> function. For example, adata.layers<!-- -->[“exon_counts”]<!-- -->` will return the exonic counts from the output h5ad. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-outputs">6. Outputs<a href="#6-outputs" class="hash-link" aria-label="Direct link to 6. Outputs" title="Direct link to 6. Outputs">​</a></h4><p>Output files of the pipeline include:</p><ol><li>Bead x Gene unnormalized count matrices in h5ad format.</li><li>Unfiltered, sorted BAM file with barcode and downstream analysis tags.</li><li>Bead metadata, including bead metrics.</li><li>Gene metadata, including gene metrics.</li></ol><p>The following table lists the output files produced from the pipeline. For samples that have sequenced over multiple lanes, the pipeline will output one merged version of each listed file.</p><table><thead><tr><th>Output Name</th><th>Filename, if applicable</th><th>Output Type</th><th>Output Format</th></tr></thead><tbody><tr><td>pipeline_version_out</td><td>N/A</td><td>Version of the processing pipeline run on this data.</td><td>String</td></tr><tr><td>genomic_reference_version</td><td><code>reference_version.txt</code></td><td>File containing genomic reference source, build, and annotation versions.</td><td>TXT</td></tr><tr><td>bam</td><td><code>&lt;output_bam_basename&gt;.bam</code></td><td>Aligned BAM</td><td>BAM</td></tr><tr><td>matrix</td><td><code>&lt;input_id&gt;_sparse_counts.npz</code></td><td>Converted sparse matrix file from the MergeStarOutputs task.</td><td>NPZ</td></tr><tr><td>matrix_row_index</td><td><code>&lt;input_id&gt;_sparse_counts_row_index.npy</code></td><td>Index of beads in count matrix.</td><td>NPY</td></tr><tr><td>matrix_col_index</td><td><code>&lt;input_id&gt;_sparse_counts_col_index.npy</code></td><td>Index of genes in count matrix.</td><td>NPY</td></tr><tr><td>cell_metrics</td><td><code>cell-metrics.csv.gz</code></td><td>Cell metrics based on bead barcodes</td><td>Compressed CSV</td></tr><tr><td>gene_metrics</td><td><code>gene-metrics.csv.gz</code></td><td>Gene metrics</td><td>Compressed CSV</td></tr><tr><td>umi_metrics</td><td><code>umi-metrics.csv.gz</code></td><td>UMI metrics</td><td>Compressed CSV</td></tr><tr><td>fastq_barcode_distribution</td><td><code>&lt;input_id&gt;.barcode_distribution_XC.txt</code></td><td>Metric file containing the distribution of reads per bead barcode that were calculated prior to alignment.</td><td>TXT</td></tr><tr><td>fastq_umi_distribution</td><td><code>&lt;input_id&gt;.barcode_distribution_XM.txt</code></td><td>Metric file containing the distribution of reads per UMI that were calculated prior to alignment.</td><td>TXT</td></tr><tr><td>fastq_reads_per_cell</td><td><code>&lt;input_id&gt;.numReads_perCell_XC.txt</code></td><td>Metric file containing the number of reads per barcode that were calculated prior to alignment.</td><td>TXT</td></tr><tr><td>fastq_reads_per_umi</td><td><code>&lt;input_id&gt;.numReads_perCell_XM.txt</code></td><td>Metric file containing the number of reads per UMI that were calculated prior to alignment.</td><td>TXT</td></tr><tr><td>h5ad_output_file</td><td><code>&lt;input_id&gt;.h5ad</code></td><td>h5ad file containing count data and metadata.</td><td>H5AD</td></tr></tbody></table><p>The h5ad matrix is the default output. This matrix contains the unnormalized (unfiltered) count matrices, as well as the gene and bead barcode metrics detailed in the <a href="/warp/docs/Pipelines/SlideSeq_Pipeline/count-matrix-overview">Slide-seq Count Matrix Overview</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="validation-against-on-prem-pipeline">Validation against on-prem pipeline<a href="#validation-against-on-prem-pipeline" class="hash-link" aria-label="Direct link to Validation against on-prem pipeline" title="Direct link to Validation against on-prem pipeline">​</a></h2><p>Slide-seq has been validated for processing mouse spatial transcriptomic data generated with the Slide-seq assay. Slide-seq results are compared to those of an on-premise pipeline using BCL input files and python scripts. See the <a href="https://docs.google.com/document/d/1cmfG3Y4uGvfJUJZV9MZvgN5Yw6-bFajpS7lonMKxdso/edit?usp=sharing" target="_blank" rel="noopener noreferrer">validation report</a> for more information.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="versioning-and-testing">Versioning and testing<a href="#versioning-and-testing" class="hash-link" aria-label="Direct link to Versioning and testing" title="Direct link to Versioning and testing">​</a></h2><p>All Slide-seq pipeline releases are documented in the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/wdl/slideseq/SlideSeq.changelog.md" target="_blank" rel="noopener noreferrer">Slide-seq changelog</a> and tested using <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/wdl/slideseq/test_inputs/test_data_overview.md" target="_blank" rel="noopener noreferrer">plumbing and scientific test data</a>. To learn more about WARP pipeline testing, see <a href="https://broadinstitute.github.io/warp/docs/About_WARP/TestingPipelines" target="_blank" rel="noopener noreferrer">Testing Pipelines</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="citing-the-slide-seq-pipeline">Citing the Slide-seq Pipeline<a href="#citing-the-slide-seq-pipeline" class="hash-link" aria-label="Direct link to Citing the Slide-seq Pipeline" title="Direct link to Citing the Slide-seq Pipeline">​</a></h2><p>If you use the Slide-seq Pipeline in your research, please identify the pipeline in your methods section using the <a href="https://scicrunch.org/resources/data/record/nlx_144509-1/SCR_023379/resolver?q=%22Slide-seq%22&amp;l=%22Slide-seq%22&amp;i=rrid:scr_023379" target="_blank" rel="noopener noreferrer">Slide-seq SciCrunch resource identifier</a>.</p><ul><li>Ex: <em>Slide-seq Pipeline (RRID:SCR_023379)</em></li></ul><p>Please also consider citing our preprint:</p><p>Degatano, K., Awdeh, A., Cox III, R.S., Dingman, W., Grant, G., Khajouei, F., Kiernan, E., Konwar, K., Mathews, K.L., Palis, K., et al. Warp Analysis Research Pipelines: Cloud-optimized workflows for biological data processing and reproducible analysis. Bioinformatics 2025; btaf494. <a href="https://doi.org/10.1093/bioinformatics/btaf494" target="_blank" rel="noopener noreferrer">https://doi.org/10.1093/bioinformatics/btaf494</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="consortia-support">Consortia support<a href="#consortia-support" class="hash-link" aria-label="Direct link to Consortia support" title="Direct link to Consortia support">​</a></h2><p>This pipeline is supported by the <a href="https://biccn.org/" target="_blank" rel="noopener noreferrer">BRAIN Initiative Cell Census Network</a> (BICCN) and BRAIN Initiative Cell Atlas Network (BICAN). </p><p>If your organization also uses this pipeline, we would like to list you! Please reach out to us by <a href="https://github.com/broadinstitute/warp/issues" target="_blank" rel="noopener noreferrer">filing an issue in WARP</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="feedback">Feedback<a href="#feedback" class="hash-link" aria-label="Direct link to Feedback" title="Direct link to Feedback">​</a></h2><p>Please help us make our tools better by <a href="https://github.com/broadinstitute/warp/issues" target="_blank" rel="noopener noreferrer">filing an issue in WARP</a>; we welcome pipeline-related suggestions or questions.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/broadinstitute/warp/edit/develop/website/docs/Pipelines/SlideSeq_Pipeline/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-11-12T16:18:32.000Z">Nov 12, 2025</time></b> by <b>M. Morgan Aster</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/warp/docs/Pipelines/RNA_with_UMIs_Pipeline/rna-with-umis.methods"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">RNA with UMIs v1.0.16 Methods</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/warp/docs/Pipelines/SlideSeq_Pipeline/count-matrix-overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Slide-seq Count Matrix Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-the-slide-seq-workflow" class="table-of-contents__link toc-highlight">Introduction to the Slide-seq workflow</a></li><li><a href="#quickstart-table" class="table-of-contents__link toc-highlight">Quickstart table</a></li><li><a href="#set-up" class="table-of-contents__link toc-highlight">Set-up</a><ul><li><a href="#slide-seq-installation" class="table-of-contents__link toc-highlight">Slide-seq installation</a></li><li><a href="#inputs" class="table-of-contents__link toc-highlight">Inputs</a></li></ul></li><li><a href="#slide-seq-tasks-and-tools" class="table-of-contents__link toc-highlight">Slide-seq tasks and tools</a></li><li><a href="#validation-against-on-prem-pipeline" class="table-of-contents__link toc-highlight">Validation against on-prem pipeline</a></li><li><a href="#versioning-and-testing" class="table-of-contents__link toc-highlight">Versioning and testing</a></li><li><a href="#citing-the-slide-seq-pipeline" class="table-of-contents__link toc-highlight">Citing the Slide-seq Pipeline</a></li><li><a href="#consortia-support" class="table-of-contents__link toc-highlight">Consortia support</a></li><li><a href="#feedback" class="table-of-contents__link toc-highlight">Feedback</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/warp/docs/get-started">Get Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Guide and Policy</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/warp/docs/contribution/README">Contribution Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/warp/privacy">Privacy</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/warp/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">Changelog</a></li><li class="footer__item"><a href="https://github.com/broadinstitute/warp" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Copyright © Data Sciences Platform, Broad Institute.</div></div></div></footer></div>
<script src="/warp/assets/js/runtime~main.4d6b11e4.js"></script>
<script src="/warp/assets/js/main.845a3bc9.js"></script>
</body>
</html>