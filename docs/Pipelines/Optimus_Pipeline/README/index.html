<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/warp/blog/rss.xml" title="WARP Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/warp/blog/atom.xml" title="WARP Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-181048107-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="WARP" href="/warp/opensearch.xml">
<script>!function(t,h,e,j,s,n){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:2427684,hjsv:6},s=h.getElementsByTagName("head")[0],(n=h.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,s.appendChild(n)}(window,document)</script><title data-react-helmet="true">Optimus Overview | WARP</title><meta data-react-helmet="true" property="og:url" content="https://broadinstitute.github.io/warp/docs/Pipelines/Optimus_Pipeline/README"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Optimus Overview | WARP"><meta data-react-helmet="true" name="description" content="| Pipeline Version | Date Updated | Documentation Author | Questions or Feedback |"><meta data-react-helmet="true" property="og:description" content="| Pipeline Version | Date Updated | Documentation Author | Questions or Feedback |"><link data-react-helmet="true" rel="shortcut icon" href="/warp/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://broadinstitute.github.io/warp/docs/Pipelines/Optimus_Pipeline/README"><link data-react-helmet="true" rel="alternate" href="https://broadinstitute.github.io/warp/docs/Pipelines/Optimus_Pipeline/README" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://broadinstitute.github.io/warp/docs/Pipelines/Optimus_Pipeline/README" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/warp/assets/css/styles.3e26694e.css">
<link rel="preload" href="/warp/assets/js/runtime~main.cc0ba1fb.js" as="script">
<link rel="preload" href="/warp/assets/js/main.5d48e811.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/warp/"><strong class="navbar__title">WARP Pipelines</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link--active" href="/warp/docs/get-started">Documentation</a><a class="navbar__item navbar__link" href="/warp/blog">Blog</a><a href="https://github.com/broadinstitute/warp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/warp/"><strong class="navbar__title">WARP Pipelines</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/warp/docs/get-started">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/warp/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/broadinstitute/warp" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/warp/docs/get-started">Welcome to WARP</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About WARP</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/About_WARP/BestPractices">Best Practices for Building Data Processing Pipelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/About_WARP/PipelineRequirements">Pipeline Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/About_WARP/TestingPipelines">Testing Pipelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/About_WARP/VersionAndReleasePipelines">Version and Release Pipelines</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">WARP Pipelines</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">CEMBA</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/CEMBA_MethylC_Seq_Pipeline/README">CEMBA Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/CEMBA_MethylC_Seq_Pipeline/CEMBA.methods">CEMBA_v1.1.0 Publication Methods</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Exome Germline Single Sample</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Exome_Germline_Single_Sample_Pipeline/README">Exome Germline Single Sample Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">GDC Whole Genome Somatic Single Sample</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Genomic_Data_Commons_Whole_Genome_Somatic/README">Genomic Data Commons (GDC) Whole Genome Somatic Single Sample Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Illumina Genotyping Array</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Illumina_Genotyping_Arrays_Pipeline/IlluminaGenotypingArray.documentation">Illumina Genotyping Array Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Illumina_Genotyping_Arrays_Pipeline/Illumina_genotyping_array_spec">VCF Overview: Illumina Genotyping Array</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Optimus</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/warp/docs/Pipelines/Optimus_Pipeline/README">Optimus Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/Optimus_Pipeline/optimus.methods">Optimus v4.2.4 Methods</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/Optimus_Pipeline/Bam_tags">What tags are included in an Optimus BAM file?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/Optimus_Pipeline/Loom_schema">Optimus Count Matrix Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Single Cell ATAC</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Single_Cell_ATAC_Seq_Pipeline/README">scATAC Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Single_Cell_ATAC_Seq_Pipeline/scatac.methods">scATAC v1.2.0 Methods</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Smart-seq2 Multi-Sample</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Smart-seq2_Multi_Sample_Pipeline/README">Smart-seq2 Multi-Sample Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Smart-seq2_Multi_Sample_Pipeline/smart-seq2.methods">Smart-seq2 Multi-Sample v2.2.1 Publication Methods</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Smart-seq2_Multi_Sample_Pipeline/Loom_schema">What&#x27;s in the Smart-seq2 Multi Sample Pipeline Loom File?</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Smart-seq2 Single Nucleus Multi-Sample</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Smart-seq2_Single_Nucleus_Multi_Sample_Pipeline/README">Smart-seq2 Single Nucleus Multi-Sample Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Smart-seq2 Single Nucleus</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Smart-seq2_Single_Nucleus_Pipeline/README">Smart-seq2 Single Nucleus Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Smart-seq2 Single Sample</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Smart-seq2_Single_Sample_Pipeline/README">Smart-seq2 Single Sample Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Smart-seq2_Single_Sample_Pipeline/Loom_schema">What&#x27;s in the Smart-seq2 Single Sample Pipeline Loom File?</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Whole Genome Germline Single Sample</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Whole_Genome_Germline_Single_Sample_Pipeline/README">Whole Genome Germline Single Sample Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/Pipelines/Whole_Genome_Germline_Single_Sample_Pipeline/wgs.methods">Whole Genome Germline Single Sample v2.2.0 Methods</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contribution Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/contribution/README">Welcome</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Contribute to WARP</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/contribution/contribute_to_warp/changelog_style">Changelog Style Guide Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Contribute to WARP Documentation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/contribution/contribute_to_warp_docs/docsite_maintenance">WARP Documentation Maintenance Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/warp/docs/contribution/contribute_to_warp_docs/doc_style">Documentation Style Guide</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Optimus Overview</h1></header><div class="markdown"><table><thead><tr><th align="center">Pipeline Version</th><th align="center">Date Updated</th><th align="center">Documentation Author</th><th align="center">Questions or Feedback</th></tr></thead><tbody><tr><td align="center"><a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer">optimus_v4.2.3</a></td><td align="center">January, 2021</td><td align="center"><a href="mailto:ekiernan@broadinstitute.org" target="_blank" rel="noopener noreferrer">Elizabeth Kiernan</a></td><td align="center">Please file GitHub issues in warp or contact <a href="mailto:kdegatano@broadinstitute.org" target="_blank" rel="noopener noreferrer">Kylee Degatano</a></td></tr></tbody></table><p><img alt="Optimus_diagram" src="/warp/assets/images/Optimus_diagram-bdccff4478d33356bb199e59f3018657.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="introduction-to-the-optimus-workflow"></a>Introduction to the Optimus Workflow<a class="hash-link" href="#introduction-to-the-optimus-workflow" title="Direct link to heading">#</a></h2><p>Optimus is an open-source, cloud-optimized pipeline developed by the Data Coordination Platform (DCP) of the <a href="https://data.humancellatlas.org/" target="_blank" rel="noopener noreferrer">Human Cell Atlas (HCA) Project</a>. It supports processing of any 3&#x27; single-cell and single-nucleus count data generated with the <a href="https://www.10xgenomics.com/solutions/single-cell/" target="_blank" rel="noopener noreferrer">10x Genomic v2 or v3 assay</a>.</p><p>It is an alignment and transcriptome quantification pipeline that corrects cell barcodes, aligns reads to the genome, corrects Unique Molecular Identifiers (UMIs), generates a count matrix in a UMI-aware manner, calculates summary metrics for genes and cells, detects empty droplets, returns read outputs in BAM format, and returns cell gene counts in numpy matrix and Loom file formats.</p><p><strong>In addition to providing commonly used metrics such as empty drop detection and mitochondrial reads, Optimus takes special care to keep all reads that may be useful to the downstream user</strong>, such as unaligned reads or reads with uncorrectable barcodes. This design provides flexibility to the downstream user and allows for alternative filtering or leveraging the data for novel methodological development.</p><p>Optimus has been validated for analyzing both human and mouse single-cell or single-nucleus data sets. Learn more in the <a href="#validation-against-cell-ranger">validation section</a>.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Want to use the Optimus Pipeline for your publication?</h5></div><div class="admonition-content"><p>Check out the <a href="/warp/docs/Pipelines/Optimus_Pipeline/optimus.methods">Optimus Publication Methods</a> to get started!</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="quick-start-table"></a>Quick Start Table<a class="hash-link" href="#quick-start-table" title="Direct link to heading">#</a></h2><table><thead><tr><th>Pipeline Features</th><th>Description</th><th>Source</th></tr></thead><tbody><tr><td>Assay Type</td><td>10x Single Cell or Single Nucleus Expression (v2 and v3)</td><td><a href="https://www.10xgenomics.com" target="_blank" rel="noopener noreferrer">10x Genomics</a></td></tr><tr><td>Overall Workflow</td><td>Quality control module and transcriptome quantification module</td><td>Code available from <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/Optimus.wdl" target="_blank" rel="noopener noreferrer">GitHub</a></td></tr><tr><td>Workflow Language</td><td>WDL 1.0</td><td><a href="https://github.com/openwdl/wdl" target="_blank" rel="noopener noreferrer">openWDL</a></td></tr><tr><td>Genomic Reference Sequence</td><td>GRCh38 human genome primary sequence and M21 (GRCm38.p6) mouse genome primary sequence</td><td>GENCODE <a href="https://www.gencodegenes.org/human/release_27.html" target="_blank" rel="noopener noreferrer">Human</a> and <a href="https://www.gencodegenes.org/mouse/release_M21.html" target="_blank" rel="noopener noreferrer">Mouse</a></td></tr><tr><td>Transcriptomic Reference Annotation</td><td>V27 GENCODE human transcriptome and M21 mouse transcriptome</td><td>GENCODE <a href="ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_27/gencode.v27.annotation.gtf.gz" target="_blank" rel="noopener noreferrer">Human</a> and <a href="ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_mouse/release_M21/gencode.vM21.annotation.gff3.gz" target="_blank" rel="noopener noreferrer">Mouse</a></td></tr><tr><td>Aligner</td><td>STAR (v.2.5.3a)</td><td><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3530905/" target="_blank" rel="noopener noreferrer">Dobin, et al.,2013</a></td></tr><tr><td>Transcript Quantification</td><td>Utilities for processing large-scale single cell datasets</td><td><a href="https://github.com/HumanCellAtlas/sctools" target="_blank" rel="noopener noreferrer">sctools</a></td></tr><tr><td>Data Input File Format</td><td>File format in which sequencing data is provided</td><td><a href="https://academic.oup.com/nar/article/38/6/1767/3112533" target="_blank" rel="noopener noreferrer">FASTQ</a></td></tr><tr><td>Data Output File Format</td><td>File formats in which Optimus output is provided</td><td><a href="http://samtools.github.io/hts-specs/" target="_blank" rel="noopener noreferrer">BAM</a>, Python numpy arrays (internal), Loom (generated with <a href="http://loompy.org/" target="_blank" rel="noopener noreferrer">Loompy v.3.0.6)</a></td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="set-up"></a>Set-up<a class="hash-link" href="#set-up" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="optimus-installation-and-requirements"></a>Optimus Installation and Requirements<a class="hash-link" href="#optimus-installation-and-requirements" title="Direct link to heading">#</a></h3><p>The Optimus pipeline code can be downloaded by cloning the GitHub repository <a href="https://github.com/broadinstitute/warp/" target="_blank" rel="noopener noreferrer">warp</a>. For the latest release of Optimus, please see the release tags prefixed with &quot;Optimus&quot; <a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Optimus can be deployed using <a href="https://cromwell.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">Cromwell</a>, a GA4GH compliant, flexible workflow management system that supports multiple computing platforms. Optimus can also be run in <a href="https://app.terra.bio" target="_blank" rel="noopener noreferrer">Terra</a>, a cloud-based analysis platform. The Terra <a href="https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline" target="_blank" rel="noopener noreferrer">Optimus Featured Workspace</a> contains the Optimus workflow, workflow configurations, required reference data and other inputs, and example testing data.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="inputs"></a>Inputs<a class="hash-link" href="#inputs" title="Direct link to heading">#</a></h3><p>Optimus pipeline inputs are detailed in JSON format configuration files. There are four example configuration files available if you are interested in running the pipeline:</p><ul><li><a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/human_v2_example.json" target="_blank" rel="noopener noreferrer">human_v2_example</a>: An example human 10x v2 single-cell dataset</li><li><a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/human_v3_example.json" target="_blank" rel="noopener noreferrer">human_v3_example</a>: An example human 10x v3 single-cell dataset</li><li><a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/mouse_v2_example.json" target="_blank" rel="noopener noreferrer">mouse_v2_example</a>: An example mouse 10x v2 single-cell dataset</li><li><a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/mouse_v2_snRNA_example.json" target="_blank" rel="noopener noreferrer">mouse_v2_snRNA_example</a>: An example mouse v2 single-nucleus dataset</li></ul><p>Additionally, there are multiple sample datasets available in the <a href="https://github.com/broadinstitute/warp/tree/master/pipelines/skylab/optimus/example_inputs/test_optimus_full_datasets" target="_blank" rel="noopener noreferrer">test_optimus_full_datasets</a> folder. Please note that unlike the example configuration files above, the configuration files in this folder may not reflect updated Optimus parameters. However, you can still access the FASTQ files for each dataset at the Google bucket locations listed in the dataset configuration files.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sample-data-input"></a>Sample Data Input<a class="hash-link" href="#sample-data-input" title="Direct link to heading">#</a></h4><p>Each 10x v2 and v3 3‚Äô sequencing experiment generates triplets of FASTQ files for any given sample:</p><ol><li>Forward reads (<code>r1_fastq</code>) containing the unique molecular identifier (UMI) and cell barcode sequences</li><li>Reverse reads (<code>r2_fastq</code>) containing the alignable genomic information from the mRNA transcript</li><li>Index FASTQ (<code>i1_fastq</code>) containing the sample barcodes, when provided by the sequencing facility</li></ol><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Optimus is currently a single sample pipeline</h5></div><div class="admonition-content"><p>However, it can take in multiple sets of FASTQs for a sample that has been split over multiple lanes of sequencing. For an example configuration file with multiple lanes, please see the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/mouse_v2_example.json" target="_blank" rel="noopener noreferrer">mouse_v2_example.json</a>. Additionally, Optimus does not support demultiplexing even though it accepts index FASTQ files.</p></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="additional-reference-inputs"></a>Additional Reference Inputs<a class="hash-link" href="#additional-reference-inputs" title="Direct link to heading">#</a></h4><p>The JSON file also contains metadata for the reference information in the following table:</p><table><thead><tr><th>Parameter Name</th><th>Description</th><th>Optional Strings (when applicable)</th></tr></thead><tbody><tr><td>whitelist</td><td>Cloud path to list of known cell barcodes from <a href="https://www.10xgenomics.com/" target="_blank" rel="noopener noreferrer">10x genomics</a> that corresponds to the v2 or v3 chemistry</td><td>NA</td></tr><tr><td>tar_star_reference</td><td>Cloud path to TAR file containing a species-specific reference genome and gtf; it is generated using the <a href="https://github.com/broadinstitute/warp/tree/develop/pipelines/skylab/build_indices/BuildIndices.wdl" target="_blank" rel="noopener noreferrer">BuildIndices.wdl</a></td><td>NA</td></tr><tr><td>input_id</td><td>Unique identifier describing the biological sample or replicate that corresponds with the FASTQ files; can be a human-readable name or UUID</td><td>NA</td></tr><tr><td>input_name</td><td>Optional string that can be used to further identify the original biological sample</td><td>NA</td></tr><tr><td>input_id_metadata_field</td><td>Optional string describing, when applicable, the metadata field containing the input_id</td><td>NA</td></tr><tr><td>input_name_metadata_field</td><td>Optional string describing, when applicable, the metadata field containing the input_name</td><td>NA</td></tr><tr><td>annotations_gtf</td><td>Cloud path to GTF containing gene annotations used for gene tagging (must match GTF in STAR reference)</td><td>NA</td></tr><tr><td>chemistry</td><td>Optional string description of whether data was generated with 10x v2 or v3 chemistry. Optimus validates this string. If the string does not match one of the optional strings, the pipeline will fail. You can remove the checks by setting &quot;force_no_check = true&quot; in the input JSON</td><td>&quot;tenX_v2&quot; (default) or &quot;tenX_v3&quot;</td></tr><tr><td>counting_mode</td><td>String description of whether data is single-cell or single-nucleus</td><td>&quot;sc_rna&quot; or &quot;sn_rna&quot;</td></tr><tr><td>output_bam_basename</td><td>Optional string used for the output BAM file basename; the default is input_id</td><td>NA</td></tr><tr><td>use_strand_info</td><td>Optional string for reading stranded data. Default is &quot;false&quot;; set to &quot;true&quot; to count reads in stranded mode</td><td>&quot;true&quot; or &quot;false&quot; (default)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sample-inputs-for-analyses-in-a-terra-workspace"></a>Sample Inputs for Analyses in a Terra Workspace<a class="hash-link" href="#sample-inputs-for-analyses-in-a-terra-workspace" title="Direct link to heading">#</a></h4><p>The Optimus pipeline is currently available on the cloud-based platform Terra. If you have a Terra account, you can access the Featured Workspace using this address: <a href="https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline" target="_blank" rel="noopener noreferrer">https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline</a>. The workspace is preloaded with instructions and sample data. For more information on using the Terra platform, please view the <a href="https://support.terra.bio/hc/en-us" target="_blank" rel="noopener noreferrer">Support Center</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="optimus-tasks-and-tools"></a>Optimus Tasks and Tools<a class="hash-link" href="#optimus-tasks-and-tools" title="Direct link to heading">#</a></h2><p>The <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/Optimus.wdl" target="_blank" rel="noopener noreferrer">Optimus.wdl</a> in the pipelines/optimus folder of the WARP repository implements the workflow by importing individual modules (&quot;tasks&quot; written in  WDL script) from the WARP <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab" target="_blank" rel="noopener noreferrer">tasks</a> folder.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="optimus-task-summary"></a>Optimus Task Summary<a class="hash-link" href="#optimus-task-summary" title="Direct link to heading">#</a></h3><p>Here we describe the tasks of the Optimus pipeline; <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/Optimus.wdl" target="_blank" rel="noopener noreferrer">the code</a> and <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab" target="_blank" rel="noopener noreferrer">library of tasks</a> are available through GitHub.</p><p>Overall, the workflow:</p><ol><li>Converts R2 FASTQ file (containing alignable genomic information) to an unaligned BAM (UBAM)</li><li>Corrects and attaches 10x Barcodes using the R1 FASTQ file</li><li>Aligns reads to the genome with STAR v.2.5.3a</li><li>Annotates genes with aligned reads</li><li>Corrects UMIs</li><li>Calculates summary metrics</li><li>Produces a UMI-aware count matrix</li><li>Detects empty droplets</li><li>Returns a GA4GH compliant BAM and a count matrix in Loom formats</li></ol><p>The tools each Optimus task employs are detailed in the table below. If you are looking for the parameters for each task/tool, please click on the task link and see the <code>command {}</code> section of the task WDL script. The task&#x27;s Docker image is specified in the task WDL <code># runtime values</code> section as <code>String docker =</code>.</p><table><thead><tr><th>Task and WDL Link</th><th>Tool</th></tr></thead><tbody><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/FastqProcessing.wdl" target="_blank" rel="noopener noreferrer">FastqProcessing</a></td><td><a href="https://sctools.readthedocs.io/en/latest/sctools.html" target="_blank" rel="noopener noreferrer">sctools</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/StarAlignBamSingleEnd.wdl" target="_blank" rel="noopener noreferrer">StarAlignBamSingleEnd</a></td><td><a href="https://github.com/alexdobin/STAR" target="_blank" rel="noopener noreferrer">STAR</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/TagGeneExon.wdl" target="_blank" rel="noopener noreferrer">TagGeneExon</a></td><td><a href="https://github.com/broadinstitute/Drop-seq" target="_blank" rel="noopener noreferrer">Drop-seq</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/UmiCorrection.wdl" target="_blank" rel="noopener noreferrer">UmiCorrection</a></td><td><a href="https://github.com/CGATOxford/UMI-tools" target="_blank" rel="noopener noreferrer">Umi-tools</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/SequenceDataWithMoleculeTagMetrics.wdl" target="_blank" rel="noopener noreferrer">SequenceDataWithMoleculeTagMetrics</a></td><td><a href="https://sctools.readthedocs.io/en/latest/sctools.html" target="_blank" rel="noopener noreferrer">sctools</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/RunEmptyDrops.wdl" target="_blank" rel="noopener noreferrer">RunEmptyDrops</a></td><td><a href="https://bioconductor.org/packages/release/bioc/html/DropletUtils.html" target="_blank" rel="noopener noreferrer">dropletUtils</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/CreateCountMatrix.wdl" target="_blank" rel="noopener noreferrer">CreateCountMatrix</a></td><td><a href="https://github.com/broadinstitute/Drop-seq" target="_blank" rel="noopener noreferrer">Drop-seq</a> and <a href="https://sctools.readthedocs.io/en/latest/sctools.html" target="_blank" rel="noopener noreferrer">sctools</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/FastqToUBam.wdl" target="_blank" rel="noopener noreferrer">FastqToUBAM</a></td><td><a href="https://github.com/broadinstitute/picard" target="_blank" rel="noopener noreferrer">picard</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/SplitBamByCellBarcode.wdl" target="_blank" rel="noopener noreferrer">SplitBamByCellBarcode</a></td><td><a href="https://sctools.readthedocs.io/en/latest/sctools.html" target="_blank" rel="noopener noreferrer">sctools</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/TagSortBam.wdl" target="_blank" rel="noopener noreferrer">TagSortBam</a></td><td><a href="https://sctools.readthedocs.io/en/latest/sctools.html" target="_blank" rel="noopener noreferrer">sctools</a></td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/Picard.wdl" target="_blank" rel="noopener noreferrer">Picard</a></td><td><a href="https://github.com/broadinstitute/picard" target="_blank" rel="noopener noreferrer">picard</a></td></tr></tbody></table><p>The Optimus pipeline takes special care to flag but avoid the removal of reads that are not aligned or that do not contain recognizable barcodes. This design (which differs from many pipelines currently available) allows the use of the entire dataset by those who may want to use alternative filtering or leverage the data for methodological development associated with the data processing. More information about the different tags used to flag the data can be found in the <a href="/warp/docs/Pipelines/Optimus_Pipeline/Bam_tags">Bam_tags documentation</a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-converting-r2-fastq-file-to-ubam"></a>1. Converting R2 FASTQ File to UBAM<a class="hash-link" href="#1-converting-r2-fastq-file-to-ubam" title="Direct link to heading">#</a></h4><p>Unlike FASTQ files, BAM files enable researchers to keep track of important metadata throughout all data processing steps. The first step of Optimus is to <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/FastqProcessing.wdl" target="_blank" rel="noopener noreferrer">convert</a> the R2 FASTQ file, containing the alignable genomic information, to an unaligned BAM (UBAM) file.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-correcting-and-attaching-cell-barcodes"></a>2. Correcting and Attaching Cell Barcodes<a class="hash-link" href="#2-correcting-and-attaching-cell-barcodes" title="Direct link to heading">#</a></h4><p>Although the function of the cell barcodes is to identify unique cells, barcode errors can arise during sequencing (such as incorporation of the barcode into contaminating DNA or sequencing and PCR errors), making it difficult to distinguish unique cells from artifactual appearances of the barcode. The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/FastqProcessing.wdl" target="_blank" rel="noopener noreferrer">FastqProcessing</a> task uses <a href="https://github.com/HumanCellAtlas/sctools" target="_blank" rel="noopener noreferrer">sctools</a> to evaluate barcode errors by comparing the R1 FASTQ sequences against a whitelist of known barcode sequences. The task then appends the UMI and cell barcode sequences from the R1 FASTQ to the UBAM sequence as tags <a href="/warp/docs/Pipelines/Optimus_Pipeline/Bam_tags">(see the Bam_tags documentation for details</a>).</p><p>The output is a UBAM file containing the reads with corrected barcodes, including barcodes that came within one edit distance (<a href="http://www.levenshtein.net/" target="_blank" rel="noopener noreferrer">Levenshtein distance</a>) of matching the whitelist of barcode sequences and were corrected by this tool. Correct barcodes are assigned a ‚ÄúCB‚Äù tag. Uncorrectable barcodes (with more than one error) are preserved and given a ‚ÄúCR‚Äù (Cell barcode Raw) tag. Cell barcode quality scores are also preserved in the file under the ‚ÄúCY‚Äù tag.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-alignment"></a>3. Alignment<a class="hash-link" href="#3-alignment" title="Direct link to heading">#</a></h4><p>Optimus uses the <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/StarAlignBamSingleEnd.wdl" target="_blank" rel="noopener noreferrer">STAR alignment</a> task to map barcoded reads in the UBAM file to the genome primary assembly reference (see table above for version information). This task uses STAR (Spliced Transcripts Alignment to a Reference) a standard, splice-aware, RNA-seq alignment tool <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3530905/" target="_blank" rel="noopener noreferrer">(Dobin, et al., 2013)</a>. The default soft-clipping is turned on for this alignment.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-gene-annotation"></a>4. Gene Annotation<a class="hash-link" href="#4-gene-annotation" title="Direct link to heading">#</a></h4><p>The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/TagGeneExon.wdl" target="_blank" rel="noopener noreferrer">TagGeneExon</a> task uses <a href="https://github.com/broadinstitute/Drop-seq" target="_blank" rel="noopener noreferrer">Drop-seq tools</a> to <a href="/warp/docs/Pipelines/Optimus_Pipeline/Bam_tags">annotate each read</a> with the type of sequence to which it aligns. These annotations vary depending on the counting_mode (&quot;sc_rna&quot; or &quot;sn_rna&quot;) specified in the workflow.</p><p><strong>Single-cell RNA-seq:</strong></p><p>The TagGeneExon task calls Drop-seq tools v1.12 to make annotations. These annotations include INTERGENIC, INTRONIC, UTR and CODING (EXONIC), and are stored using the &#x27;XF&#x27; BAM tag. In cases where the gene corresponds to an exon or UTR, the name of the gene that overlaps the alignment is associated with the read and stored using the GE BAM tag.</p><p><strong>Single-nucleus RNA-seq:</strong></p><p>The TagGeneExon task calls Drop-seq tools v2.3.0 to make annotations. These annotations include INTERGENIC, INTRONIC, UTR and CODING (EXONIC), and are stored using the &#x27;XF&#x27; BAM tag (see the <a href="/warp/docs/Pipelines/Optimus_Pipeline/Bam_tags">Bam_tags documentation</a>). In cases where the gene corresponds to an exon, UTR, or intron, the name of the gene that overlaps the alignment is associated with the read and stored using the &#x27;GE&#x27; BAM tag.</p><p>All tags are detailed in the pipeline&#x27;s <a href="/warp/docs/Pipelines/Optimus_Pipeline/Bam_tags">BAM_tag documentation</a>.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Single-nucleus count matrices do not account for strand</h5></div><div class="admonition-content"><p>While Optimus can use the stranded mode to flag strand info in the BAM file, this information is not currently used in the downstream matrix. This results in potentially higher counts than expected for single-nucleus data. Work is in-progress to account for strand information in the final matrix.</p></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="5-umi-correction"></a>5. UMI Correction<a class="hash-link" href="#5-umi-correction" title="Direct link to heading">#</a></h4><p>UMIs are designed to distinguish unique transcripts present in the cell at lysis from those arising from PCR amplification of these same transcripts. But, like cell barcodes, UMIs can also be incorrectly sequenced or amplified. The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/UmiCorrection.wdl" target="_blank" rel="noopener noreferrer">UmiCorrection</a> task uses <a href="https://pypi.org/project/umi-tools/0.0.1/" target="_blank" rel="noopener noreferrer">Umi-tools v.0.0.1</a> to apply a network-based, &quot;directional&quot; correction method (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5340976/" target="_blank" rel="noopener noreferrer">Smith, et al., 2017</a>) to account for such errors. This task makes UMI corrections to alignments made with the &#x27;GE&#x27; tag. This step will add a &#x27;UB&#x27; tag for UMI-corrected barcodes.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6-summary-metric-calculation"></a>6. Summary Metric Calculation<a class="hash-link" href="#6-summary-metric-calculation" title="Direct link to heading">#</a></h4><p>The <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/SequenceDataWithMoleculeTagMetrics.wdl" target="_blank" rel="noopener noreferrer">Metrics</a> task uses <a href="https://github.com/HumanCellAtlas/sctools" target="_blank" rel="noopener noreferrer">sctools</a> to calculate summary metrics which help assess the quality of the data output each time this pipeline is run. These metrics are included in the Loom output file. A detailed list of these metrics is found in the <a href="/warp/docs/Pipelines/Optimus_Pipeline/Loom_schema">Loom_schema documentation</a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="7-count-matrix-construction"></a>7. Count Matrix Construction<a class="hash-link" href="#7-count-matrix-construction" title="Direct link to heading">#</a></h4><p>The Optimus <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/CreateCountMatrix.wdl" target="_blank" rel="noopener noreferrer">CreateCountMatrix</a> task (imported as &quot;Count&quot;) evaluates every read in the BAM file and creates a UMI-aware count matrix using <a href="https://github.com/HumanCellAtlas/sctools" target="_blank" rel="noopener noreferrer">sctools</a>. This matrix contains the number of molecules that were observed for each cell barcode and for each gene. The task discards any read that maps to more than one gene, and counts any remaining reads provided the triplet of cell barcode, molecule barcode, and gene name is unique, indicating the read originates from a single transcript present at the time of cell lysis. To correctly specific the gene name tag, this task will look for the &#x27;GE&#x27; tag.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="8-identification-of-empty-droplets"></a>8. Identification of Empty Droplets<a class="hash-link" href="#8-identification-of-empty-droplets" title="Direct link to heading">#</a></h4><p>Empty droplets are lipid droplets that did not encapsulate a cell during 10x sequencing, but instead acquired cell-free RNA (secreted RNA or RNA released during cell lysis) from the solution in which the cells resided (<a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=30902100" target="_blank" rel="noopener noreferrer">Lun, et al., 2018</a>. This ambient RNA can serve as a substrate for reverse transcription, leading to a small number of background reads. The Optimus pipeline calls the <a href="https://github.com/broadinstitute/warp/blob/master/tasks/skylab/RunEmptyDrops.wdl" target="_blank" rel="noopener noreferrer">RunEmptyDrops</a> task which uses the <a href="http://bioconductor.org/packages/release/bioc/html/DropletUtils.html" target="_blank" rel="noopener noreferrer">DropletUtils v1.2.1</a> R package to flag cell barcodes that represent empty droplets rather than cells. A cell will be flagged if it contains fewer than 100 molecules.</p><p>EmptyDrops relies on a visual knee point inflection (described in <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1662-y" target="_blank" rel="noopener noreferrer">Lun et al. (2019)</a>) to differentiate ambient-like cells from empty droplets. <strong>If the single-cell data (counting mode set to <code>sc_rna</code>) does not produce a knee point inflection when running EmptyDrops, the Loom columns for EmptyDrops data will contain &quot;NA&quot;s.</strong></p><p>EmptyDrops metrics for single-cell data (not single-nucleus; see note below) are stored in the columns of the output Loom matrix.  Read full details for all the metrics in the <a href="/warp/docs/Pipelines/Optimus_Pipeline/Loom_schema">Loom_schema documentation</a>.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>RunEmptyDrops output not included for single-nucleus data</h5></div><div class="admonition-content"><p>Often snRNAseq data does not produce a visual knee point inflection when running EmptyDrops and the tool can not accurately distinguish ambient-like cells from empty droplets. For this reason, EmptyDrops is not used if Optimus counting_mode is set to <code>sn_rna</code>, and the output Loom matrix will not contain EmptyDrops metrics.</p></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="9-outputs"></a>9. Outputs<a class="hash-link" href="#9-outputs" title="Direct link to heading">#</a></h4><p>Output files of the pipeline include:</p><ol><li>Cell x Gene unnormalized, but UMI-corrected, count matrices</li><li>Unfiltered, sorted BAM file with barcode and downstream analysis <a href="/warp/docs/Pipelines/Optimus_Pipeline/Bam_tags">tags</a></li><li>Cell metadata, including cell metrics</li><li>Gene metadata, including gene metrics</li></ol><p>The following table lists the output files produced from the pipeline. For samples that have sequenced over multiple lanes, the pipeline will output one merged version of each listed file.</p><table><thead><tr><th>Output Name</th><th>Filename, if applicable</th><th>Output Type</th><th>Output Format</th></tr></thead><tbody><tr><td>pipeline_version</td><td></td><td>Version of the processing pipeline run on this data</td><td>String</td></tr><tr><td>bam</td><td><code>&lt;input_id&gt;.bam</code></td><td>Aligned BAM</td><td>BAM</td></tr><tr><td>matrix_row_index</td><td>sparse_counts_row_index.npy</td><td>Index of cells in count matrix</td><td>Numpy array index</td></tr><tr><td>matrix_col_index</td><td>sparse_counts_col_index.npy</td><td>Index of genes in count matrix</td><td>Numpy array index</td></tr><tr><td>cell_metrics</td><td>merged-cell-metrics.csv.gz</td><td>cell metrics</td><td>compressed csv</td></tr><tr><td>gene_metrics</td><td>merged-gene-metrics.csv.gz</td><td>gene metrics</td><td>compressed csv</td></tr><tr><td>loom_output_file</td><td><code>&lt;input_id&gt;.loom</code></td><td>Loom</td><td>Loom</td></tr></tbody></table><p>The Loom matrix is the default output. See the <a href="https://github.com/broadinstitute/warp/blob/master/dockers/skylab/loom-output/create_loom_optimus.py" target="_blank" rel="noopener noreferrer">create_loom_optimus.py</a> for the detailed code. This matrix contains the unnormalized (unfiltered), UMI-corrected count matrices, as well as the gene and cell metrics detailed in the <a href="/warp/docs/Pipelines/Optimus_Pipeline/Loom_schema">Optimus Count Matrix Overview documentation</a>.</p><p>The matrix is compatible with multiple downstream community analysis tools. For a tutorial on using the Optimus matrix with <a href="https://satijalab.org/seurat/index.html" target="_blank" rel="noopener noreferrer">Seurat</a>, <a href="https://scanpy.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">Scanpy</a>, <a href="https://cumulus.readthedocs.io/en/latest/index.html" target="_blank" rel="noopener noreferrer">Cumulus</a>, or <a href="https://pegasus.readthedocs.io/en/stable/#" target="_blank" rel="noopener noreferrer">Pegasus</a>, see the public <a href="https://app.terra.bio/#workspaces/featured-workspaces-hca/Intro-to-HCA-data-on-Terra" target="_blank" rel="noopener noreferrer">Intro-to-HCA-data-on-Terra workspace</a> (login required) and its accompanying <a href="https://support.terra.bio/hc/en-us/articles/360060041772" target="_blank" rel="noopener noreferrer">step-by-step guide</a>.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Zarr Array Deprecation Notice June 2020</h5></div><div class="admonition-content"><p>Please note that we have deprecated the previously used Zarr array output. The pipeline now uses the Loom file format as the default output.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="validation-against-cell-ranger"></a>Validation against Cell Ranger<a class="hash-link" href="#validation-against-cell-ranger" title="Direct link to heading">#</a></h2><p>Optimus has been validated for processing both human and mouse single-cell and single-nucleus data (see links to validation reports in the table below). For each validation, Optimus results are compared to those of Cell Ranger (see the <a href="#faqs">FAQ</a> for more on Cell Ranger comparisons).</p><table><thead><tr><th>Workflow configuration</th><th>Link to Report</th></tr></thead><tbody><tr><td>Human 10x v2 single-cell</td><td><a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/benchmarking/v1_Apr2019/optimus_report.rst" target="_blank" rel="noopener noreferrer">Report</a></td></tr><tr><td>Mouse 10x v2 single-cell</td><td><a href="https://docs.google.com/document/d/1_3oO0ZQSrwEoe6D3GgKdSmAQ9qkzH_7wrE7x6_deL10/edit" target="_blank" rel="noopener noreferrer">Report</a></td></tr><tr><td>Human and mouse 10x v3 single-cell</td><td><a href="https://docs.google.com/document/d/1-hwfXkqtL8MblgDWFzk-HsVRYiy4PS8ZhJqAGlHBWYE/edit#heading=h.4uokn64v1s5m" target="_blank" rel="noopener noreferrer">Report</a></td></tr><tr><td>Human and Mouse 10x v2/v3 single-nucleus</td><td><a href="https://docs.google.com/document/d/1rv2M7vfpOzIOsMnMfNyKB4HV18lQ9dnOGHK2tPikiH0/edit" target="_blank" rel="noopener noreferrer">Report</a></td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="versioning"></a>Versioning<a class="hash-link" href="#versioning" title="Direct link to heading">#</a></h2><p>All Optimus pipeline releases are documented in the <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/skylab/optimus/Optimus.changelog.md" target="_blank" rel="noopener noreferrer">Optimus changelog</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="citing-the-optimus-pipeline"></a>Citing the Optimus Pipeline<a class="hash-link" href="#citing-the-optimus-pipeline" title="Direct link to heading">#</a></h2><p>Please identify the pipeline in your methods section using the Optimus Pipeline&#x27;s <a href="https://scicrunch.org/scicrunch/Resources/record/nlx_144509-1/SCR_018908/resolver?q=SCR_018908&amp;l=SCR_018908" target="_blank" rel="noopener noreferrer">SciCrunch resource identifier</a>.</p><ul><li>Ex: <em>Optimus Pipeline (RRID:SCR_018908)</em></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="have-suggestions"></a>Have Suggestions?<a class="hash-link" href="#have-suggestions" title="Direct link to heading">#</a></h2><p>Coming soon, we will have a GitHub document dedicated to open issues! In the meantime, please help us make our tools better by contacting <a href="mailto:kdegatano@broadinstitute.org" target="_blank" rel="noopener noreferrer">Kylee Degatano</a> for pipeline-related suggestions or questions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="faqs"></a>FAQs<a class="hash-link" href="#faqs" title="Direct link to heading">#</a></h2><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Question Can I run Optimus in Terra?</h5></div><div class="admonition-content"><p>Yes! We have a Terra workspace that is preconfigured with the latest Optimus workflow and is preloaded with human and mouse sample data. You can access the <a href="https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline" target="_blank" rel="noopener noreferrer">workspace</a>. You will need a Google account to set up Terra. Please see <a href="https://support.terra.bio/hc/en-us" target="_blank" rel="noopener noreferrer">Terra Support</a> for documents on getting started.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Question Is the output count matrix filtered or normalized?</h5></div><div class="admonition-content"><p>No, we do not filter. We keep as much data as possible so that the researcher can make their own filtering and normalization choices. We do, however, output some information that may be helpful for filtering, like UMI counts per cell and calls on whether or not a cell is empty from EmptyDrops software. For the EmptyDrops call, a cell will be flagged as possibly empty if it contains fewer than 100 molecules.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Question How does the workflow change when using the single-cell RNA-seq (counting_mode = &#x27;sc_rna&#x27;) vs. the single-nucleus (counting_mode = &#x27;sn_rna&#x27;) parameters?</h5></div><div class="admonition-content"><p>Three Optimus tasks are affected by the counting_mode parameter: TagGeneExon, UMICorrection and CreateCountMatrix. The TagGeneExon task uses different versions of Drop-seq tools depending on the counting_mode parameter. The sc_rna parameter uses v1.12 whereas the sn_rna uses v2.3.0. For the sn_rna parameter, a GE tag is added to intronic reads. For the UMICorrection and CreateCountMatrix tasks, the only difference related to the counting_mode parameters is that the sn_RNA parameter will have a GE tag on intronic reads, which the UMICorrection and CreateCountMatrix will recognize.
Also note that although the RunEmptyDrops task is unaffected by the sn_rna parameter, the final Zarr and Loom outputs will not include EmptyDrops data for the sn_rna mode.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Question Where can I find example Optimus datasets and parameters to test the pipeline?</h5></div><div class="admonition-content"><p>There are four example configuration JSON files available for you to test the pipeline- the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/human_v2_example.json" target="_blank" rel="noopener noreferrer">human_v2_example.json</a>, the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/human_v3_example.json" target="_blank" rel="noopener noreferrer">human_v3_example.json</a>, the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/mouse_v2_snRNA_example.json" target="_blank" rel="noopener noreferrer">mouse_v2_snRNA_example.json</a>, and the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/mouse_v2_snRNA_example.json" target="_blank" rel="noopener noreferrer">mouse_v2_snRNA_example.json</a>(see the Inputs section). Each of these configuration files can be run in the Optimus Featured Workspace in Terra at <a href="https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline" target="_blank" rel="noopener noreferrer">https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline</a>, but you should note that the workspace comes preloaded with the same data and configurations. We also have multiple example datasets available in the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/test_optimus_full_datasets/" target="_blank" rel="noopener noreferrer">test_optimus_full_datasets</a> folder. These datasets contain configuration files listing the cloud location of the dataset FASTQ files; however, the configuration files may not be updated with all the workflow parameters. For the most up-to-date configuration examples, see the four example files listed above.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Question What outputs are expected if my sample has been sequenced over multiple lanes?</h5></div><div class="admonition-content"><p>The Optimus pipeline is a single sample pipeline, but it can accept multiple FASTQ files if a sample is sequenced across lanes. In this case, the pipeline will merge the results from each lane into single output files. There will only be one merged file for each output type (i.e one Loom, etc.). If you would like to view an example configuration file for a multi-lane dataset, please see the <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/example_inputs/mouse_v2_example.json" target="_blank" rel="noopener noreferrer">mouse_v2_example.json</a>.  Additionally, you can view sample outputs in the Optimus featured workspace on <a href="https://app.terra.bio/#workspaces/featured-workspaces-hca/HCA_Optimus_Pipeline" target="_blank" rel="noopener noreferrer">Terra</a>.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Question How do I find which parameters and Docker images were used for the different tasks (i.e. STAR alignment, emptyDrops, etc.)</h5></div><div class="admonition-content"><p>Parameters are listed in each task WDL. For a list of the tasks, see the table in the <a href="#optimus-task-summary">Task Summary Section</a>. Select the link for the task of interest and then view the parameters in the task WDL &quot;command {}&quot; section. For the task Docker image, see task WDL &quot;# runtime values&quot; section; the Docker is listed as &quot;String docker =  &quot;. If you want to learn more about all the different parameters available for a software tool, please select the relevant link in the table&#x27;s &quot;Tool&quot; column.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Question Does Optimus have any read length requirements?</h5></div><div class="admonition-content"><p>For Read 1 sequences, the only minimum requirement is that reads are the combined lengths of the cell barcode and UMIs (which will vary between 10x V1, V2, and V3 chemistry).</p><p>For Read 2 sequences, there is no read length requirement and read lengths will vary.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Question How does Optimus compare to Cell Ranger?</h5></div><div class="admonition-content"><p>Cell Ranger is a commonly used set of analysis pipelines developed by <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger" target="_blank" rel="noopener noreferrer">10x Genomics</a>. Optimus and Cell Ranger share many features and additionally, Optimus results are validated against Cell Ranger results (see our <a href="https://github.com/broadinstitute/warp/blob/master/pipelines/skylab/optimus/benchmarking/v1_Apr2019/optimus_report.rst" target="_blank" rel="noopener noreferrer">human validation report</a>).</p><p><em>So why develop an independent pipeline for 10x data analyses?</em></p><p>For three reasons:
1) Need for an open source, cloud-optimized pipeline. When Optimus was developed, Cell Ranger software was not yet open source, nor was it optimized for the cloud. To date, the Cell Ranger open source code is still not regularly updated with Cell Ranger releases. In consequence, using the latest Cell Ranger (which is not open source yet) limits our ability to harness the breadth of tools available in the scientific community.</p><p>2) Flexibility to process data similar, but not identical, to 10x. We wanted the ability to evolve our pipeline to process non-10x data types that might use similar features such as combinatorial indexing.</p><p>3) Addition of metrics. We wanted the pipeline to calculate key metrics that would be useful to the scientific community, such as emptyDrops calculations, mitochondrial read metrics, etc.</p></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/broadinstitute/warp/edit/develop/website/docs/Pipelines/Optimus_Pipeline/README.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-06-16T14:19:20.000Z" class="lastUpdatedDate_1WI_">6/16/2021</time> by <strong>ekiernan</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/warp/docs/Pipelines/Illumina_Genotyping_Arrays_Pipeline/Illumina_genotyping_array_spec"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ VCF Overview: Illumina Genotyping Array</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/warp/docs/Pipelines/Optimus_Pipeline/optimus.methods"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Optimus v4.2.4 Methods ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-the-optimus-workflow" class="table-of-contents__link">Introduction to the Optimus Workflow</a></li><li><a href="#quick-start-table" class="table-of-contents__link">Quick Start Table</a></li><li><a href="#set-up" class="table-of-contents__link">Set-up</a><ul><li><a href="#optimus-installation-and-requirements" class="table-of-contents__link">Optimus Installation and Requirements</a></li><li><a href="#inputs" class="table-of-contents__link">Inputs</a></li></ul></li><li><a href="#optimus-tasks-and-tools" class="table-of-contents__link">Optimus Tasks and Tools</a><ul><li><a href="#optimus-task-summary" class="table-of-contents__link">Optimus Task Summary</a></li></ul></li><li><a href="#validation-against-cell-ranger" class="table-of-contents__link">Validation against Cell Ranger</a></li><li><a href="#versioning" class="table-of-contents__link">Versioning</a></li><li><a href="#citing-the-optimus-pipeline" class="table-of-contents__link">Citing the Optimus Pipeline</a></li><li><a href="#have-suggestions" class="table-of-contents__link">Have Suggestions?</a></li><li><a href="#faqs" class="table-of-contents__link">FAQs</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/warp/docs/get-started">Get Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Guide and Policy</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/warp/docs/contribution/README">Contribution Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/warp/privacy">Privacy</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/warp/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">Changelog</a></li><li class="footer__item"><a href="https://github.com/broadinstitute/warp" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 Copyright ¬© Data Sciences Platform, Broad Institute.</div></div></div></footer></div>
<script src="/warp/assets/js/runtime~main.cc0ba1fb.js"></script>
<script src="/warp/assets/js/main.5d48e811.js"></script>
</body>
</html>