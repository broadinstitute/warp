<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Pipelines/Ultima_Genomics_Whole_Genome_Germline_Pipeline/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Ultima Genomics Whole Genome Germline Overview | WARP</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://broadinstitute.github.io/warp/docs/Pipelines/Ultima_Genomics_Whole_Genome_Germline_Pipeline/README"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ultima Genomics Whole Genome Germline Overview | WARP"><meta data-rh="true" name="description" content="| Pipeline Version | Date Updated | Documentation Authors | Questions or Feedback |"><meta data-rh="true" property="og:description" content="| Pipeline Version | Date Updated | Documentation Authors | Questions or Feedback |"><link data-rh="true" rel="icon" href="/warp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://broadinstitute.github.io/warp/docs/Pipelines/Ultima_Genomics_Whole_Genome_Germline_Pipeline/README"><link data-rh="true" rel="alternate" href="https://broadinstitute.github.io/warp/docs/Pipelines/Ultima_Genomics_Whole_Genome_Germline_Pipeline/README" hreflang="en"><link data-rh="true" rel="alternate" href="https://broadinstitute.github.io/warp/docs/Pipelines/Ultima_Genomics_Whole_Genome_Germline_Pipeline/README" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BX0CVVQ6KQ-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/warp/blog/rss.xml" title="WARP RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/warp/blog/atom.xml" title="WARP Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZ4BLRHQYS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NZ4BLRHQYS",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="WARP" href="/warp/opensearch.xml">
<script>!function(t,h,e,j,s,n){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:2427684,hjsv:6},s=h.getElementsByTagName("head")[0],(n=h.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,s.appendChild(n)}(window,document)</script><link rel="stylesheet" href="/warp/assets/css/styles.ddc3fdb8.css">
<link rel="preload" href="/warp/assets/js/runtime~main.e21075f0.js" as="script">
<link rel="preload" href="/warp/assets/js/main.845a3bc9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/warp/"><b class="navbar__title text--truncate">WARP Pipelines</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/warp/docs/get-started">Documentation</a><a class="navbar__item navbar__link" href="/warp/blog">Blog</a><a href="https://github.com/broadinstitute/warp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/warp/docs/get-started">Welcome to WARP</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/warp/docs/About_WARP/BestPractices">About WARP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/warp/docs/Pipelines/ATAC/README">WARP Pipelines</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/ATAC/README">ATAC</a><button aria-label="Toggle the collapsible sidebar category &#x27;ATAC&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/BuildIndices_Pipeline/README">BuildIndices</a><button aria-label="Toggle the collapsible sidebar category &#x27;BuildIndices&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Exome_Germline_Single_Sample_Pipeline/README">Exome Germline Single Sample</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exome Germline Single Sample&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Illumina_Genotyping_Arrays_Pipeline/README">Illumina Genotyping Array</a><button aria-label="Toggle the collapsible sidebar category &#x27;Illumina Genotyping Array&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/ImputationBeagle_Pipeline/README">ImputationBeagle</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Imputation_Pipeline/README">Imputation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Imputation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/JointGenotyping_Pipeline/README">JointGenotyping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/Multiome_Pipeline/README">Multiome scATAC and GEX</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Optimus_Pipeline/README">Optimus</a><button aria-label="Toggle the collapsible sidebar category &#x27;Optimus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/PairedTag_Pipeline/README">Paired-Tag</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/RNA_with_UMIs_Pipeline/README">RNA with UMIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;RNA with UMIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/SlideSeq_Pipeline/README">Slide-seq</a><button aria-label="Toggle the collapsible sidebar category &#x27;Slide-seq&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/warp/docs/Pipelines/SlideTags_Pipeline/README">Slide-tags</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Smart-seq2_Single_Nucleus_Multi_Sample_Pipeline/README">Smart-seq2 Single Nucleus Multi-Sample</a><button aria-label="Toggle the collapsible sidebar category &#x27;Smart-seq2 Single Nucleus Multi-Sample&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/snm3C/README">Single Nucleus Methyl-Seq and Chromatin Capture</a><button aria-label="Toggle the collapsible sidebar category &#x27;Single Nucleus Methyl-Seq and Chromatin Capture&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/warp/docs/Pipelines/Ultima_Genomics_Whole_Genome_Germline_Pipeline/README">Ultima Genomics Whole Genome Germline</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/warp/docs/Pipelines/Whole_Genome_Germline_Single_Sample_Pipeline/README">Whole Genome Germline Single Sample</a><button aria-label="Toggle the collapsible sidebar category &#x27;Whole Genome Germline Single Sample&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/warp/docs/Best_practices/GC_cost_optimization">WDL Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/warp/docs/Pipelines/CEMBA_MethylC_Seq_Pipeline/README">Deprecated Pipelines</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/warp/docs/contribution/README">Contribution Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Contribution Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/warp/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">WARP Pipelines</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Ultima Genomics Whole Genome Germline</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Ultima Genomics Whole Genome Germline Overview</h1><table><thead><tr><th align="center">Pipeline Version</th><th align="center">Date Updated</th><th align="center">Documentation Authors</th><th align="center">Questions or Feedback</th></tr></thead><tbody><tr><td align="center"><a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer">UltimaGenomicsWholeGenomeGermline_v1.1.5</a></td><td align="center">March, 2025</td><td align="center">Elizabeth Kiernan &amp; Kaylee Mathews</td><td align="center">Please <a href="https://github.com/broadinstitute/warp/issues" target="_blank" rel="noopener noreferrer">file an issue in WARP</a>.</td></tr></tbody></table><p><img loading="lazy" alt="UG_diagram" src="/warp/assets/images/ug_diagram-f967ed2cc6a58e654c0a27f1e9bf8d3b.png" width="350" height="631" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-the-ug_wgs-workflow">Introduction to the UG_WGS workflow<a href="#introduction-to-the-ug_wgs-workflow" class="hash-link" aria-label="Direct link to Introduction to the UG_WGS workflow" title="Direct link to Introduction to the UG_WGS workflow">​</a></h2><p>The <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/germline/single_sample/ugwgs/UltimaGenomicsWholeGenomeGermline.wdl" target="_blank" rel="noopener noreferrer">Ultima Genomics Whole Genome Germline (UG_WGS) workflow</a> is an open-source, cloud-optimized workflow for processing whole-genome germline sequencing data generated using the Ultima Genomics sequencing platform. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="background-ultima-genomics-sequencing">Background: Ultima Genomics sequencing<a href="#background-ultima-genomics-sequencing" class="hash-link" aria-label="Direct link to Background: Ultima Genomics sequencing" title="Direct link to Background: Ultima Genomics sequencing">​</a></h3><p>Ultima Genomics sequencing is a novel technology that produces single-read, flow-based data (<a href="https://www.biorxiv.org/content/10.1101/2022.05.29.493900v1" target="_blank" rel="noopener noreferrer">Almogy et al., 2022</a>). The sequencing platform works by flowing one nucleotide at a time in order, iteratively. This is in contrast to traditional technologies that do all four nucleotides at once. This iterative approach ensures that only one dNTP is responsible for the signal and it does not require the blocking of dNTPs.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-does-the-workflow-do">What does the workflow do?<a href="#what-does-the-workflow-do" class="hash-link" aria-label="Direct link to What does the workflow do?" title="Direct link to What does the workflow do?">​</a></h3><p>The workflow requires either an aligned CRAM output of the sequencing platform or an unmapped BAM as input. Overall, it aligns reads to a reference genome, marks duplicate reads, calls variants, post-processes variants in the output VCF in preparation for joint calling, and calculates quality control metrics. The workflow outputs a (re)aligned CRAM, an annotated GVCF with index, and quality metrics. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up">Set-up<a href="#set-up" class="hash-link" aria-label="Direct link to Set-up" title="Direct link to Set-up">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">​</a></h3><p>To download the latest release of the UG_WGS pipeline, see the release tags prefixed with &quot;UG_WGS&quot; on the WARP <a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer">releases page</a>. All releases of the UG_WGS pipeline are documented in the <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/germline/single_sample/ugwgs/UltimaGenomicsWholeGenomeGermline.changelog.md" target="_blank" rel="noopener noreferrer">UG_WGS changelog</a>. </p><p>To search releases of this and other pipelines, use the WARP command-line tool <a href="https://github.com/broadinstitute/warp/tree/develop/wreleaser" target="_blank" rel="noopener noreferrer">Wreleaser</a>.</p><p>The UG_WGS pipeline can be deployed using <a href="https://cromwell.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">Cromwell</a>, a GA4GH compliant, flexible workflow management system that supports multiple computing platforms. The workflow can also be run in <a href="https://app.terra.bio" target="_blank" rel="noopener noreferrer">Terra</a>, a cloud-based analysis platform. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="inputs">Inputs<a href="#inputs" class="hash-link" aria-label="Direct link to Inputs" title="Direct link to Inputs">​</a></h3><p>The UG_WGS workflow inputs are specified in JSON configuration files. An example configuration file can be found in the <a href="https://github.com/broadinstitute/warp/tree/develop/pipelines/wdl/dna_seq/germline/single_sample/ugwgs/input_files" target="_blank" rel="noopener noreferrer">input_files</a> folder in the WARP repository. </p><p>Multiple workflow inputs are in the form of structs, which are defined in <a href="https://github.com/broadinstitute/warp/blob/develop/structs/dna_seq/UltimaGenomicsWholeGenomeGermlineStructs.wdl" target="_blank" rel="noopener noreferrer">UG_WGS structs WDL</a>. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="input-descriptions">Input descriptions<a href="#input-descriptions" class="hash-link" aria-label="Direct link to Input descriptions" title="Direct link to Input descriptions">​</a></h4><p>The workflow takes in an aligned CRAM (output of the Ultima Genomics sequencing platform) or an unmapped BAM file for one sample and one read group. </p><p>The workflow input variables are listed below. If an input variable is part of a struct, the struct name is listed in the <code>Struct</code> column.</p><table><thead><tr><th>Input variable name</th><th>Struct</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>input_cram_list</td><td>N/A</td><td>Array of CRAM files to be used as workflow input; must be specified if <code>input_bam_list</code> is not provided.</td><td>Array <!-- -->[File]</td></tr><tr><td>input_bam_list</td><td>N/A</td><td>Array of unmapped BAM files to be used as workflow input; must be specified if <code>input_cram_list</code> is not provided.</td><td>Array <!-- -->[File]</td></tr><tr><td>base_file_name</td><td>N/A</td><td>Base name for each of the output files.</td><td>String</td></tr><tr><td>contamination_sites_path</td><td>ContaminationSites</td><td>Path to contamination site files.</td><td>String</td></tr><tr><td>contamination_sites_vcf</td><td>ContaminationSites</td><td>Contamination site VCF.</td><td>File</td></tr><tr><td>contamination_sites_vcf_index</td><td>ContaminationSites</td><td>Index for contamination site VCF.</td><td>File</td></tr><tr><td>ref_fasta</td><td>References</td><td>Reference FASTA file used for alignment with BWA-MEM.</td><td>File</td></tr><tr><td>ref_fasta_index</td><td>References</td><td>Reference FASTA index file used for alignment with BWA-MEM.</td><td>File</td></tr><tr><td>ref_dict</td><td>References</td><td>Dictionary file used for alignment with BWA-MEM.</td><td>File</td></tr><tr><td>ref_alt</td><td>AlignmentReferences</td><td>Reference files used for alignment with BWA-MEM.</td><td>File</td></tr><tr><td>ref_amb</td><td>AlignmentReferences</td><td>Reference files used for alignment with BWA-MEM.</td><td>File</td></tr><tr><td>ref_ann</td><td>AlignmentReferences</td><td>Reference files used for alignment with BWA-MEM.</td><td>File</td></tr><tr><td>ref_bwt</td><td>AlignmentReferences</td><td>Reference files used for alignment with BWA-MEM.</td><td>File</td></tr><tr><td>ref_pac</td><td>AlignmentReferences</td><td>Reference files used for alignment with BWA-MEM.</td><td>File</td></tr><tr><td>ref_sa</td><td>AlignmentReferences</td><td>Reference files used for alignment with BWA-MEM.</td><td>File</td></tr><tr><td>wgs_calling_interval_list</td><td>VariantCallingSettings</td><td>Interval list used for variant calling with HaplotypeCaller.</td><td>File</td></tr><tr><td>break_bands_at_multiples_of</td><td>VariantCallingSettings</td><td>Breaks reference bands up at genomic positions that are multiples of this number; used to reduce GVCF file size.</td><td>Int</td></tr><tr><td>haplotype_scatter_count</td><td>VariantCallingSettings</td><td>Scatter count used for variant calling.</td><td>Int</td></tr><tr><td>make_haplotype_bam</td><td>N/A</td><td>Boolean indicating if HaplotypeCaller should output a bamout file; default is set to &quot;false&quot;.</td><td>Boolean</td></tr><tr><td>rsq_threshold</td><td>NA</td><td>Threshold for a read quality metric that is produced by the sequencing platform; default set to 1.0</td><td>Float</td></tr><tr><td>annotation_intervals</td><td>VcfPostProcessing</td><td>Annotation intervals used for filtering and annotating the HaplotypeCaller output VCF.</td><td>Array<!-- -->[File]</td></tr><tr><td>filtering_model_no_gt</td><td>VcfPostProcessing</td><td>Optional filtering file defining the model for VCF postprocessing.</td><td>File</td></tr><tr><td>af_only_gnomad</td><td>VcfPostProcessing</td><td>VCF with gnomAD allele frequencies used for metric stratification in the AnnotateVCF_AF task.</td><td>File</td></tr><tr><td>af_only_gnomad_index</td><td>VcfPostProcessing</td><td>Index for the <code>af_only_gnomad</code> VCF.</td><td>File</td></tr><tr><td>filter_cg_insertions</td><td>VcfPostProcessing</td><td>Boolean that indicates whether to filter CG insertions in HaplotypeCaller output VCF.</td><td>Boolean</td></tr><tr><td>filtering_blocklist_file</td><td>VcfPostProcessing</td><td>Optional file used to flag genomic locations that can’t be trusted while filtering the HaplotypeCaller output VCF.</td><td>File</td></tr><tr><td>training_blocklist_file</td><td>VcfPostProcessing</td><td>Optional interval file for training a model to postprocess the HaplotypeCaller output VCF to identify false positives.</td><td>File</td></tr><tr><td>exome_weight</td><td>VcfPostProcessing</td><td>Optional interval for exome weight that is used to train a model to identify false positives in the HaplotypeCaller output VCF.</td><td>Int</td></tr><tr><td>exome_weight_annotation</td><td>VcfPostProcessing</td><td>Optional string to annotate exome weights.</td><td>String</td></tr><tr><td>interval_list_override</td><td>VcfPostProcessing</td><td>Optional interval list to use for VCF postprocessing</td><td>File</td></tr><tr><td>runs_file</td><td>VcfPostProcessing</td><td>BED file of homopolymer runs that can be difficult to sequence.</td><td>File</td></tr><tr><td>filtering_model_with_gt_name_override</td><td>VcfPostProcessing</td><td>Optional string to describe the optional filtering model with gt.</td><td>String</td></tr><tr><td>max_duplication_in_reasonable_sample</td><td>VcfPostProcessing</td><td>Number indicating the maximum duplication expected in a sample.</td><td>Float</td></tr><tr><td>max_chimerism_in_reasonable_sample</td><td>VcfPostProcessing</td><td>Number indicating the maximum chimerism expected in a sample.</td><td>Float</td></tr><tr><td>ref_dbsnp</td><td>VcfPostProcessing</td><td>VCF with dbSNP annotations to be added to the HaplotypeCaller output VCF.</td><td>File</td></tr><tr><td>ref_dbsnp_index</td><td>VcfPostProcessing</td><td>Index for the dbSNP annotation VCF.</td><td>File</td></tr><tr><td>wgs_coverage_interval_list</td><td>VcfPostProcessing</td><td>Interval list for the CollectWgsMetrics tool.</td><td>File</td></tr><tr><td>remove_low_tree_score_sites_cutoff</td><td>VcfPostProcessing</td><td>Optional float indicating a cutoff for low tree scores</td><td>Float</td></tr><tr><td>annotations_to_keep_command_for_reblocking</td><td>VcfPostProcessing</td><td>Optional command (--annotations-to-keep) for the ReblockGVCF task indicating what types annotations to keep in the reblocked GVCF.</td><td>String</td></tr><tr><td>increase_disk_size</td><td>N/A</td><td>Interval used to increase disk size; set to 20 GB by default.</td><td>Int</td></tr><tr><td>increase_metrics_disk_size</td><td>N/A</td><td>Interval used to adjust disk size; set to 80 by default.</td><td>Int</td></tr><tr><td>filtering_model_no_gt_name</td><td>N/A</td><td>String to describe the optional filtering model; default set to &quot;rf_model_ignore_gt_incl_hpol_runs&quot;.</td><td>String</td></tr><tr><td>merge_bam_file</td><td>N/A</td><td>Boolean indicating if by-interval bamout files from HaplotypeCaller should be merged into a single BAM.</td><td>Boolean</td></tr><tr><td>reads_per_split</td><td>N/A</td><td>Number of reads by which to split the CRAM prior to alignment.</td><td>Int</td></tr><tr><td>pipeline_version</td><td>N/A</td><td>String that describes the pipeline version number.</td><td>String</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="reference-files">Reference files<a href="#reference-files" class="hash-link" aria-label="Direct link to Reference files" title="Direct link to Reference files">​</a></h4><p>Reference files, such as the hg38- and dbSNP-related files are located in a public Google bucket. See the <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/germline/single_sample/ugwgs/input_files/UltimaGenomicsWholeGenomeGermline.inputs.json" target="_blank" rel="noopener noreferrer">example input configuration file</a> for cloud locations.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ug_wgs-tasks-and-tools">UG_WGS tasks and tools<a href="#ug_wgs-tasks-and-tools" class="hash-link" aria-label="Direct link to UG_WGS tasks and tools" title="Direct link to UG_WGS tasks and tools">​</a></h2><p>The <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/germline/single_sample/ugwgs/UltimaGenomicsWholeGenomeGermline.wdl" target="_blank" rel="noopener noreferrer">UG_WGS workflow</a> imports additional WDL scripts that contain the different workflow tasks. When applicable, links to these additional WDL scripts (subtasks/subworkflows) are provided in the summary section below. </p><ul><li><p>Workflow tasks use different software tools to manipulate the workflow input data. To see specific tool parameters, select the task WDL link in the table; then find the task and view the <code>command {}</code> section of the task in the WDL script. </p></li><li><p>To view or use the exact tool software, see the task&#x27;s Docker image which is specified in the task WDL <code>input {}</code> section as <code>String docker =</code>. </p></li><li><p>Docker images for the UG_WGS workflow are not yet versioned and officially released, but they are publicly available to test the workflow. </p></li></ul><p>Overall, the UG_WGS workflow:</p><ol><li>Aligns with BWA-MEM and marks duplicates.</li><li>Converts a merged BAM to CRAM and validates the CRAM.</li><li>Extracts the nucleotide flow order.</li><li>Calculates quality control metrics.</li><li>Performs variant calling with HaplotypeCaller.</li><li>Merges BAMs and converts the GVCF to VCF.</li><li>Performs VCF post-processing in preparation for joint calling.</li></ol><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Multiple tasks are imported from nested sub-workflows</div><div class="admonitionContent_S0QG"><p>When applicable, links to the sub-workflow WDLs and nested tasks WDLs are provided. </p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-align-and-mark-duplicates">1. Align and mark duplicates<a href="#1-align-and-mark-duplicates" class="hash-link" aria-label="Direct link to 1. Align and mark duplicates" title="Direct link to 1. Align and mark duplicates">​</a></h3><p><strong>Sub-workflow name and link:</strong> <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/somatic/single_sample/ugwgs/UltimaGenomicsWholeGenomeCramOnly.wdl" target="_blank" rel="noopener noreferrer">UltimaGenomicsWholeGenomeCramOnly</a></p><ul><li><p><strong>Nested task name and WDL link:</strong></p><p><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineAlignmentMarkDuplicates.wdl" target="_blank" rel="noopener noreferrer">UltimaGenomicsWholeGenomeGermlineAlignmentMarkDuplicates.AlignmentAndMarkDuplicates</a></p></li></ul><p>The table below details the subtasks called by the AlignmentAndMarkDuplicates task, which splits the CRAM or BAM into subfiles, converts them to uBAM format, converts the uBAM to FASTQ for alignment with BWA-MEM, and marks duplicate reads in the resulting BAM files. </p><p>The Picard tool MarkDuplicatesSpark has been adapted to handle ambiguity in the aligned start of a read. This functionality is applied using the tool’s <code>--flowbased</code> parameter.</p><table><thead><tr><th>Subtask name and WDL link</th><th>Tool</th><th>Software</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.SplitCram as SplitInputCram</a></td><td>split</td><td>crammer</td><td>If CRAM is the workflow input, splits the CRAM and outputs a split CRAM.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/Alignment.wdl" target="_blank" rel="noopener noreferrer">AlignmentTasks.SamSplitter as SplitInputBam</a></td><td>SplitSamByNumberOfReads</td><td>Picard</td><td>If BAM is workflow input, splits the BAM and outputs an array of BAMs.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.ConvertCramOrBamToUBam as ConvertToUbam</a></td><td>view, RevertSam</td><td>samtools, Picard</td><td>Converts the split CRAM or BAM file to uBAM.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.SamToFastqAndBwaMemAndMba</a></td><td>SamToFastq, bwa mem, MergeBamAlignment</td><td>Picard, bwa mem</td><td>Converts each uBAM to FASTQ format, aligns with BWA-MEM, and merges the alignment in the resulting BAM with metadata from the uBAM.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.MarkDuplicatesSpark</a></td><td>MarkDuplicatesSpark</td><td>GATK</td><td>Flags duplicate reads in the array of aligned and merged BAMs to create a new output BAM and index.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-convert-bam-to-cram-and-validate-the-cram">2. Convert BAM to CRAM and validate the CRAM<a href="#2-convert-bam-to-cram-and-validate-the-cram" class="hash-link" aria-label="Direct link to 2. Convert BAM to CRAM and validate the CRAM" title="Direct link to 2. Convert BAM to CRAM and validate the CRAM">​</a></h3><p><strong>Sub-workflow name and link:</strong> <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/somatic/single_sample/ugwgs/UltimaGenomicsWholeGenomeCramOnly.wdl" target="_blank" rel="noopener noreferrer">UltimaGenomicsWholeGenomeCramOnly</a></p><p>The two tasks below are used to convert each duplicate-marked BAM to CRAM and validate the resulting files.</p><table><thead><tr><th>TASK name and WDL link</th><th>Tool</th><th>Software</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/Utilities.wdl" target="_blank" rel="noopener noreferrer">Utilities.ConvertToCram</a></td><td>view</td><td>samtools</td><td>Converts the duplicated-marked BAM to CRAM.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/Qc.wdl" target="_blank" rel="noopener noreferrer">QC.ValidateSamFile as ValidateCram</a></td><td>ValidateSamFile</td><td>Picard</td><td>Validates the CRAM file.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-extract-nucleotide-flow-order">3. Extract nucleotide flow order<a href="#3-extract-nucleotide-flow-order" class="hash-link" aria-label="Direct link to 3. Extract nucleotide flow order" title="Direct link to 3. Extract nucleotide flow order">​</a></h3><p><strong>Sub-workflow name and link:</strong> <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/somatic/single_sample/ugwgs/UltimaGenomicsWholeGenomeCramOnly.wdl" target="_blank" rel="noopener noreferrer">UltimaGenomicsWholeGenomeCramOnly</a></p><p>The flow order is the order in which nucleotides are passed during sequencing. This information is captured in the header of the BAM and is extracted as a text file for downstream processing.</p><table><thead><tr><th>TASK name and WDL link</th><th>Tool</th><th>Software</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.ExtractSampleNameFlowOrder</a></td><td>GetSampleName</td><td>GATK</td><td>Extracts the flow order from the BAM header into a text file that is used in downstream VCF post-processing.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-calculate-quality-control-metrics">4. Calculate quality control metrics<a href="#4-calculate-quality-control-metrics" class="hash-link" aria-label="Direct link to 4. Calculate quality control metrics" title="Direct link to 4. Calculate quality control metrics">​</a></h3><p><strong>Sub-workflow name and link:</strong> <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/somatic/single_sample/ugwgs/UltimaGenomicsWholeGenomeCramOnly.wdl" target="_blank" rel="noopener noreferrer">UltimaGenomicsWholeGenomeCramOnly</a></p><ul><li><p><strong>Nested task name and WDL link:</strong></p><p><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineQC.wdl" target="_blank" rel="noopener noreferrer">UltimaGenomicsWholeGenomeGermlineQC.UltimaGenomicsWholeGenomeGermlineQC as CollectStatistics</a></p></li></ul><p>The workflow uses a contamination estimation that has been adapted to use only the highest quality SNP sites based on flow cycles and local realignment. This is different from the <a href="https://broadinstitute.github.io/warp/docs/Pipelines/Whole_Genome_Germline_Single_Sample_Pipeline/README/" target="_blank" rel="noopener noreferrer">Whole Genome Germline Single Sample</a> pipeline in that HaplotypeCaller performs local realignment and feeds that output to VerifyBAM ID, which cleans up the alignment.</p><table><thead><tr><th>Subtask name and WDL link</th><th>Tool</th><th>Software</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.HaplotypeCaller as HaplotypeCallerForContamination</a></td><td>HaplotypeCaller</td><td>GATK</td><td>Runs HaplotypeCaller using an interval list of variants with high allele frequencies (<code>contamination_sites_vcf</code>).</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.CheckContamination</a></td><td>VerifyBamID</td><td>VerifyBamID</td><td>Checks contamination in the HaplotypeCallerForContamination bamout file.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.CollectDuplicateMetrics</a></td><td>CollectDuplicateMetrics</td><td>Picard</td><td>Checks duplication metrics in the aggregated, duplicate-marked BAM file.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/Qc.wdl" target="_blank" rel="noopener noreferrer">QC.CollectQualityYieldMetrics</a></td><td>CollectQualityYieldMetrics</td><td>Picard</td><td>Calculates QC metrics on the duplicated-marked BAM.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.CollectWgsMetrics</a></td><td>CollectWgsMetrics</td><td>Picard</td><td>Collects WGS metrics on the duplicate-marked BAM using stringent thresholds.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.CollectRawWgsMetrics</a></td><td>CollectRawWgsMetrics</td><td>Picard</td><td>Collects the raw WGS metrics on the duplicated-marked BAM with commonly used QC metrics.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.CollectAggregationMetrics</a></td><td>CollectMultipleMetrics</td><td>Picard</td><td>Performs QC on the aligned, duplicated-marked BAM.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/Qc.wdl" target="_blank" rel="noopener noreferrer">QC.CheckPreValidation</a></td><td>custom script</td><td>python3</td><td>Checks chimerism and duplicate files for a given threshold using a custom python script.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-variant-call-with-haplotypecaller">5. Variant call with HaplotypeCaller<a href="#5-variant-call-with-haplotypecaller" class="hash-link" aria-label="Direct link to 5. Variant call with HaplotypeCaller" title="Direct link to 5. Variant call with HaplotypeCaller">​</a></h3><p>The workflow implements initial variant calling with a version of HaplotypeCaller that handles flow-based data. This version replaces the classic Hidden Markov Model (HMM) with a flow-based likelihood model that more accurately accounts for sequencing errors present in the data.</p><table><thead><tr><th>Task name and WDL link</th><th>Tool</th><th>Software</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/Utilities.wdl" target="_blank" rel="noopener noreferrer">Utilities.ScatterIntervalList</a></td><td>IntervalListTools</td><td>Picard</td><td>Splits the calling interval list into sub-intervals in order to perform variant calling on the sub-intervals.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.HaplotypeCaller</a></td><td>HaplotypeCaller</td><td>GATK</td><td>Performs initial variant calling on the aligned BAM file and outputs sub-interval GVCFs and a bamout file.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-merge-vcfs-and-bams-and-convert-gvcf-to-vcf">6. Merge VCFs and BAMs and convert GVCF to VCF<a href="#6-merge-vcfs-and-bams-and-convert-gvcf-to-vcf" class="hash-link" aria-label="Direct link to 6. Merge VCFs and BAMs and convert GVCF to VCF" title="Direct link to 6. Merge VCFs and BAMs and convert GVCF to VCF">​</a></h3><p>The workflow performs multiple post-processing steps to prepare the VCF for downstream joint calling. The HaplotypeCaller GVCF outputs are merged into a single GVCF and then converted to VCF in preparation for this post-processing.</p><table><thead><tr><th>Task name and WDL link</th><th>Tool</th><th>Software</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/GermlineVariantDiscovery.wdl" target="_blank" rel="noopener noreferrer">VariantDiscoverTasks.MergeVCFs</a></td><td>MergeVcfs</td><td>Picard</td><td>Merges the array of GVCFs from HaplotypeCaller into one VCF and index.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.MergeBams</a></td><td>MergeSamFiles</td><td>Picard</td><td>Merges the HaplotypeCaller bamout files into a single BAM file.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.ConvertGVCFtoVCF</a></td><td>GenotypeGVCFs</td><td>GATK</td><td>Converts to GVCF to VCF format in preparation for post-processing.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-perform-vcf-post-processing">7. Perform VCF post-processing<a href="#7-perform-vcf-post-processing" class="hash-link" aria-label="Direct link to 7. Perform VCF post-processing" title="Direct link to 7. Perform VCF post-processing">​</a></h3><p>The workflow performs post-processing steps to prepare the VCF for downstream joint calling. First, it annotates the merged HaplotypeCaller output VCF with dbSNP variants, then it trains a model, a random forest classifier (<a href="https://www.biorxiv.org/content/10.1101/2022.05.29.493900v1" target="_blank" rel="noopener noreferrer">Almogy et al., 2022</a>), to distinguish between true positive variants and false positives. Next, the model is applied to filter variants in the VCF.</p><table><thead><tr><th>Task name and WDL link</th><th>Tool</th><th>Software</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.AnnotateVCF</a></td><td>VariantAnnotator</td><td>GATK</td><td>Adds dbSNP annotations to the HaplotypeCaller output VCF and outputs a new VCF with index.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.AddIntervalAnnotationsToVCF</a></td><td>annotate</td><td>bcftools</td><td>Adds additional interval annotations to the VCF.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.TrainModel</a></td><td>Custom script (train_models_pipeline.py)</td><td>genomics.py3</td><td>Trains a model that can be applied for variant filtering to distinguish true and false-positive variants.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.AnnotateVCF_AF</a></td><td>view, index</td><td>vcfanno, bcftools</td><td>Adds gnomAD allele frequencies to the VCF for downstream metric calculation.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.FilterVCF</a></td><td>filter_variants_pipeline.py</td><td>genomics.py3</td><td>Applies a trained model to filter for high quality VCF variants.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/tasks/wdl/UltimaGenomicsWholeGenomeGermlineTasks.wdl" target="_blank" rel="noopener noreferrer">Tasks.MoveAnnotationsToGvcf</a></td><td>annotate</td><td>bcftools</td><td>Move the annotations and the tree score from the filtered VCF to produces a final post-processed GVCF and index.</td></tr><tr><td><a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/germline/joint_genotyping/reblocking/ReblockGVCF.wdl" target="_blank" rel="noopener noreferrer">ReblockGVCF.ReblockGVCF</a></td><td>ReblockGVCF</td><td>GATK</td><td>Reblocks the annotated GVCF. For more information on why the WARP germline pipelines perform reblocking, see the <a href="https://broadinstitute.github.io/warp/blog/Nov21_ReblockedGVCF" target="_blank" rel="noopener noreferrer">blog on reblocking</a>.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-outputs">8. Outputs<a href="#8-outputs" class="hash-link" aria-label="Direct link to 8. Outputs" title="Direct link to 8. Outputs">​</a></h3><p>Workflow outputs are described in the table below. </p><table><thead><tr><th>Output variable name</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>output_gvcf</td><td>Final annotated, reblocked GVCF.</td><td>File</td></tr><tr><td>output_gvcf_index</td><td>Index file for the final annotated, reblocked GVCF.</td><td>File</td></tr><tr><td>output_vcf</td><td>Annotated VCF file.</td><td>File</td></tr><tr><td>output_vcf_index</td><td>Index file for the annotated VCF.</td><td>File</td></tr><tr><td>haplotype_bam</td><td>Optional merged, duplicated-marked BAM output.</td><td>File</td></tr><tr><td>haplotype_bam_index</td><td>Index for the optional merged, duplicate-marked BAM output.</td><td>File</td></tr><tr><td>output_cram</td><td>Final duplicate-marked CRAM file.</td><td>File</td></tr><tr><td>output_cram_index</td><td>Index file for the final CRAM.</td><td>File</td></tr><tr><td>output_cram_md5</td><td>MD5 sum for the final CRAM.</td><td>File</td></tr><tr><td>selfSM</td><td>Contamination estimate from VerifyBamID.</td><td>File</td></tr><tr><td>contamination</td><td>Estimated contamination from the CheckContamination task.</td><td>Float</td></tr><tr><td>filtered_vcf</td><td>Filtered VCF file.</td><td>File</td></tr><tr><td>filtered_vcf_index</td><td>Index for the filtered VCF.</td><td>File</td></tr><tr><td>quality_yield_metrics</td><td>The quality metrics calculated for the unmapped BAM files.</td><td>File</td></tr><tr><td>wgs_metrics</td><td>Metrics from the CollectWgsMetrics tool.</td><td>File</td></tr><tr><td>raw_wgs_metrics</td><td>Metrics from the CollectRawWgsMetrics tool.</td><td>File</td></tr><tr><td>duplicate_metrics</td><td>Duplicate read metrics from the MarkDuplicates tool.</td><td>File</td></tr><tr><td>agg_alignment_summary_metrics</td><td>Alignment summary metrics for the aggregated, duplicate-marked BAM.</td><td>File</td></tr><tr><td>agg_alignment_summary_pdf</td><td>Optional PDF of the alignment summary metrics for the aggregated BAM.</td><td>File</td></tr><tr><td>agg_gc_bias_detail_metrics</td><td>GC bias detail metrics for the aggregated, duplicate-marked BAM.</td><td>File</td></tr><tr><td>agg_gc_bias_pdf</td><td>PDF of GC bias for the aggregated, duplicate-marked BAM.</td><td>File</td></tr><tr><td>agg_gc_bias_summary_metrics</td><td>Bait bias summary metrics for the aggregated, duplicate-marked BAM.</td><td>File</td></tr><tr><td>agg_quality_distribution_pdf</td><td>PDF of the quality distribution for the aggregated, duplicate-marked BAM.</td><td>File</td></tr><tr><td>agg_quality_distribution_metrics</td><td>Quality distribution metrics for the aggregated, duplicate-marked BAM.</td><td>File</td></tr><tr><td>duplication_rate</td><td>Duplication rate.</td><td>Float</td></tr><tr><td>chimerism_rate</td><td>Chimerism rate.</td><td>Float</td></tr><tr><td>is_outlier_data</td><td>Boolean that indicates if the duplication rate and chimerism rate are above a specified threshold.</td><td>Boolean</td></tr><tr><td>sample_name</td><td>Sample name from aligned BAM header.</td><td>String</td></tr><tr><td>flow_order</td><td>Flow order (FO) from the aligned BAM header.</td><td>String</td></tr><tr><td>barcode</td><td>Barcode from the aligned BAM header.</td><td>String</td></tr><tr><td>id</td><td>ID from the aligned BAM header.</td><td>String</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-outputs-for-downstream-joint-calling">Using outputs for downstream joint calling<a href="#using-outputs-for-downstream-joint-calling" class="hash-link" aria-label="Direct link to Using outputs for downstream joint calling" title="Direct link to Using outputs for downstream joint calling">​</a></h4><p>The outputs of the UG_WGS workflow are not yet compatible with the WARP <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/germline/joint_genotyping/UltimaGenomics/UltimaGenomicsJointGenotyping.wdl" target="_blank" rel="noopener noreferrer">Ultimate Genomics Joint Genotyping workflow</a>, but efforts to release the workflow are in-progress.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="versioning">Versioning<a href="#versioning" class="hash-link" aria-label="Direct link to Versioning" title="Direct link to Versioning">​</a></h2><p>All UG_WGS pipeline releases are documented in the <a href="https://github.com/broadinstitute/warp/blob/develop/pipelines/wdl/dna_seq/germline/single_sample/ugwgs/UltimaGenomicsWholeGenomeGermline.changelog.md" target="_blank" rel="noopener noreferrer">pipeline changelog</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="citing-the-ug_wgs-pipeline">Citing the UG_WGS Pipeline<a href="#citing-the-ug_wgs-pipeline" class="hash-link" aria-label="Direct link to Citing the UG_WGS Pipeline" title="Direct link to Citing the UG_WGS Pipeline">​</a></h2><p>If you use the UG_WGS Pipeline in your research, please cite our preprint:</p><p>Degatano, K., Awdeh, A., Cox III, R.S., Dingman, W., Grant, G., Khajouei, F., Kiernan, E., Konwar, K., Mathews, K.L., Palis, K., et al. Warp Analysis Research Pipelines: Cloud-optimized workflows for biological data processing and reproducible analysis. Bioinformatics 2025; btaf494. <a href="https://doi.org/10.1093/bioinformatics/btaf494" target="_blank" rel="noopener noreferrer">https://doi.org/10.1093/bioinformatics/btaf494</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="feedback">Feedback<a href="#feedback" class="hash-link" aria-label="Direct link to Feedback" title="Direct link to Feedback">​</a></h2><p>Please help us make our tools better by <a href="https://github.com/broadinstitute/warp/issues" target="_blank" rel="noopener noreferrer">filing an issue in WARP</a>; we welcome pipeline-related suggestions or questions.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/broadinstitute/warp/edit/develop/website/docs/Pipelines/Ultima_Genomics_Whole_Genome_Germline_Pipeline/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-11-06T20:46:34.000Z">Nov 6, 2025</time></b> by <b>Robert Sidney Cox</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/warp/docs/Pipelines/snM3C/snm3c.methods"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">snM3C v4.0.1 Methods</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/warp/docs/Pipelines/Whole_Genome_Germline_Single_Sample_Pipeline/README"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Whole Genome Germline Single Sample Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-the-ug_wgs-workflow" class="table-of-contents__link toc-highlight">Introduction to the UG_WGS workflow</a><ul><li><a href="#background-ultima-genomics-sequencing" class="table-of-contents__link toc-highlight">Background: Ultima Genomics sequencing</a></li><li><a href="#what-does-the-workflow-do" class="table-of-contents__link toc-highlight">What does the workflow do?</a></li></ul></li><li><a href="#set-up" class="table-of-contents__link toc-highlight">Set-up</a><ul><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a></li><li><a href="#inputs" class="table-of-contents__link toc-highlight">Inputs</a></li></ul></li><li><a href="#ug_wgs-tasks-and-tools" class="table-of-contents__link toc-highlight">UG_WGS tasks and tools</a><ul><li><a href="#1-align-and-mark-duplicates" class="table-of-contents__link toc-highlight">1. Align and mark duplicates</a></li><li><a href="#2-convert-bam-to-cram-and-validate-the-cram" class="table-of-contents__link toc-highlight">2. Convert BAM to CRAM and validate the CRAM</a></li><li><a href="#3-extract-nucleotide-flow-order" class="table-of-contents__link toc-highlight">3. Extract nucleotide flow order</a></li><li><a href="#4-calculate-quality-control-metrics" class="table-of-contents__link toc-highlight">4. Calculate quality control metrics</a></li><li><a href="#5-variant-call-with-haplotypecaller" class="table-of-contents__link toc-highlight">5. Variant call with HaplotypeCaller</a></li><li><a href="#6-merge-vcfs-and-bams-and-convert-gvcf-to-vcf" class="table-of-contents__link toc-highlight">6. Merge VCFs and BAMs and convert GVCF to VCF</a></li><li><a href="#7-perform-vcf-post-processing" class="table-of-contents__link toc-highlight">7. Perform VCF post-processing</a></li><li><a href="#8-outputs" class="table-of-contents__link toc-highlight">8. Outputs</a></li></ul></li><li><a href="#versioning" class="table-of-contents__link toc-highlight">Versioning</a></li><li><a href="#citing-the-ug_wgs-pipeline" class="table-of-contents__link toc-highlight">Citing the UG_WGS Pipeline</a></li><li><a href="#feedback" class="table-of-contents__link toc-highlight">Feedback</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/warp/docs/get-started">Get Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Guide and Policy</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/warp/docs/contribution/README">Contribution Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/warp/privacy">Privacy</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/warp/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/broadinstitute/warp/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">Changelog</a></li><li class="footer__item"><a href="https://github.com/broadinstitute/warp" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Copyright © Data Sciences Platform, Broad Institute.</div></div></div></footer></div>
<script src="/warp/assets/js/runtime~main.e21075f0.js"></script>
<script src="/warp/assets/js/main.845a3bc9.js"></script>
</body>
</html>